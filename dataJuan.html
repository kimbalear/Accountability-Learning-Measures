<style type="text/css">
    
    @charset "UTF-8";
@import url("https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;1,100;1,300;1,400;1,500&display=swap");
/* Estilo de las pestañas */
.tab {
  overflow: hidden;
  border: 1px solid #ccc;
  background-color: #f1f1f1;
}

/* Estilo de los botones dentro de las pestañas */
.tab button {
  background-color: inherit;
  float: left;
  border: none;
  outline: none;
  cursor: pointer;
  padding: 14px 16px;
  transition: 0.3s;
}

/* Cambia el color de fondo del botón cuando se hace mouseover */
.tab button:hover {
  background-color: #ddd;
}

/* Crea un estilo activo para los botones */
.tab button.active {
  background-color: #ccc;
}

/* Estilo del contenido de las pestañas */
.tabcontent {
  display: none;
  padding: 8px 8px;
  border: 1px solid #ccc;
  border-top: none;
}

.grid-SRH_ervices {
  display: grid;
  grid-template-columns: minmax(250px, auto) repeat(5, 1fr);
  grid-gap: 0px;
  border-top: 0.5px solid #CACACE;
  border-right: 0.5px solid #CACACE;
  margin-bottom: 20px;
}
.grid-SRH_ervices .grid-header {
  background-color: #5C3873;
  color: #FFFFFF;
  padding: 10px;
  text-align: center;
  border-bottom: 0.5px solid #CACACE;
  position: sticky;
  top: 48px;
  z-index: 10;
}
.grid-SRH_ervices .grid-cell {
  background-color: #f4f4f4;
  padding: 10px;
  border-bottom: 0.5px solid #CACACE;
  border-left: 0.5px solid #CACACE;
  min-width: 90px;
}
.grid-SRH_ervices .grid-cell input {
  margin: auto 0;
  width: calc(100% - 10px);
}
.grid-SRH_ervices .grid-cell-highlight {
  background-color: #f0e4f7;
}

.grid-people_reached {
  display: grid;
  grid-template-columns: minmax(250px, auto) repeat(5, 1fr);
  grid-gap: 0px;
  border-top: 0.5px solid #CACACE;
  border-right: 0.5px solid #CACACE;
  margin-bottom: 20px;
}
.grid-people_reached .grid-header {
  background-color: #5C3873;
  color: #FFFFFF;
  padding: 10px;
  text-align: center;
  border-bottom: 0.5px solid #CACACE;
}
.grid-people_reached .grid-cell {
  background-color: #f4f4f4;
  padding: 10px;
  border-bottom: 0.5px solid #CACACE;
  border-left: 0.5px solid #CACACE;
  min-width: 90px;
}
.grid-people_reached .grid-cell input {
  margin: auto 0;
  width: calc(100% - 10px);
}
.grid-people_reached .grid-cell-highlight {
  background-color: #f0e4f7;
}

.grid-commodities {
  display: grid;
  grid-template-columns: minmax(250px, auto) repeat(10, 1fr);
  grid-gap: 0px;
  border-top: 0.5px solid #CACACE;
  border-right: 0.5px solid #CACACE;
  margin-bottom: 20px;
}
.grid-commodities .grid-header {
  background-color: #5C3873;
  color: #FFFFFF;
  padding: 10px;
  text-align: center;
  border-bottom: 0.5px solid #CACACE;
  position: sticky;
  top: 48px;
  z-index: 10;
}
.grid-commodities .grid-cell {
  background-color: #f4f4f4;
  padding: 10px;
  border-bottom: 0.5px solid #CACACE;
  border-left: 0.5px solid #CACACE;
  min-width: 90px;
}
.grid-commodities .grid-cell input {
  margin: auto 0;
  width: calc(100% - 10px);
}
.grid-commodities .grid-cell-highlight {
  background-color: #f0e4f7;
}

.grid-CSE {
  display: grid;
  grid-template-columns: minmax(250px, auto) repeat(3, 1fr);
  grid-gap: 0px;
  border-top: 0.5px solid #CACACE;
  border-right: 0.5px solid #CACACE;
  margin-bottom: 20px;
}
.grid-CSE .grid-header {
  background-color: #5C3873;
  color: #FFFFFF;
  padding: 10px;
  text-align: center;
  border-bottom: 0.5px solid #CACACE;
}
.grid-CSE .grid-cell {
  background-color: #f4f4f4;
  padding: 10px;
  border-bottom: 0.5px solid #CACACE;
  border-left: 0.5px solid #CACACE;
  min-width: 90px;
}
.grid-CSE .grid-cell input {
  margin: auto 0;
  width: calc(100% - 10px);
}
.grid-CSE .grid-cell-highlight {
  background-color: #f0e4f7;
}

.grid-OIES {
  display: grid;
  grid-template-columns: 1fr 1fr;
  grid-gap: 0px;
  border-top: 0.5px solid #CACACE;
  border-right: 0.5px solid #CACACE;
  margin-bottom: 20px;
}
.grid-OIES .grid-header {
  background-color: #5C3873;
  color: #FFFFFF;
  padding: 10px;
  text-align: center;
  border-bottom: 0.5px solid #CACACE;
}
.grid-OIES .grid-cell {
  background-color: #f4f4f4;
  padding: 10px;
  border-bottom: 0.5px solid #CACACE;
  border-left: 0.5px solid #CACACE;
  min-width: 200px;
}
.grid-OIES .grid-cell .grid-number {
  float: left;
  width: 32px;
  height: auto;
  border-right: 0.5px solid #CACACE;
}
.grid-OIES .grid-cell .grid-data {
  float: left;
  width: calc(100% - 42px);
  margin-right: 8px;
}
.grid-OIES .grid-cell .grid-data input {
  margin: auto 0;
  width: calc(100% - 10px);
}
.grid-OIES .grid-cell-highlight {
  background-color: #f0e4f7;
}

/* descipt tab */
.grid-tab_descript {
  display: grid;
  grid-template-columns: 1fr;
  grid-gap: 8px;
  margin-bottom: 20px;
}
.grid-tab_descript .grid-row {
  text-align: left;
}
.grid-tab_descript .grid-row textarea {
  width: 100% !important;
  height: 100% !important;
}

.grid-textarea {
  display: grid;
  grid-template-columns: 1fr 1fr;
  grid-gap: 8px;
  margin: 20px 0;
}
.grid-textarea .grid-row {
  text-align: left;
}
.grid-textarea .grid-row textarea {
  width: 100% !important;
  height: 100% !important;
}

/* extras */
.subtitle {
  text-align: left;
  background-color: #CACACE !important;
  padding: 4px 10px !important;
}

.title_row {
  text-align: left;
}

.data {
  text-align: right;
}

.totals {
  color: #FFFFFF !important;
  background-color: #5C3873 !important;
}

.lst {
  padding-left: 30px !important;
}

.grid_cell_merge2 {
  grid-column: span 2;
}

.grid_cell_merge4 {
  grid-column: span 4;
}
.grid_cell_merge4 textarea {
  width: 100% !important;
  height: 100% !important;
}

.grid_cell_merge6 {
  grid-column: span 6;
}

.grid_cell_merge11 {
  grid-column: span 11;
}

.dotted_list {
  list-style-type: disc;
  padding-left: 50px;
}
.dotted_list li {
  margin-bottom: 5px; /* Espacio entre elementos de la lista */
}

i,
rem {
  color: rgb(138, 116, 116);
  font-weight: 300;
  font-size: 0.5em;
}

.ui-widget-content {
  border: none;
}

.ui-widget.ui-widget-content {
  border: none;
}

input[type=radio] {
  margin: 10px 0 0 10px;
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
  width: 20px;
  height: 20px;
  border-radius: 50%;
  border: 2px solid #ccc;
  margin-right: 10px;
  display: inline-block;
  position: relative;
  top: 3px;
  cursor: pointer;
}
input[type=radio]:checked {
  background-color: #00A6E2;
  border-color: #00A6E2;
}

label {
  display: flex;
  align-items: center;
  font-size: 16px;
}

.toggle-data {
  cursor: pointer;
  display: flex;
  justify-content: flex-start;
  align-items: center;
}
.toggle-data .title {
  padding-right: 8px;
}

.content {
  padding: 10px;
  margin-top: 5px;
}

.arrow {
  transition: transform 0.3s;
}

.arrow.up {
  transform: rotate(-180deg);
}

.info-icon {
  padding-right: 10px;
}

.subtotals {
  background-color: #f7e2fd !important;
}

.version {
  margin: 4px 0;
  width: max-content;
  color: #5C3873;
  font-size: 12px;
  padding: 4px;
  border: 0.5px solid #CACACE;
}

/*# sourceMappingURL=main.css.map */

</style>
<div class="fosGrandChildrenOUsCustomForm">
<div class="div-table entryForm">
<div class="tab"><button class="tablinks" data-target="Tab1" keyword="opt_c:SRHServ">SRH Services</button><button class="tablinks" data-target="Tab2" keyword="opt_c:PeopReach">People Reached</button><button class="tablinks" data-target="Tab3" keyword="opt_c:Commod">Commodities</button><button class="tablinks" data-target="Tab4" keyword="opt_c:CSEduc">Comprehensive Sexuality Education</button><button class="tablinks" data-target="Tab5" keyword="opt_c:InfoEduSess">Other Information &amp; Education Sessions</button></div>
<!----------------------------------------------------------------------- --><!-- START TAB 1 -->

<div class="tabcontent" id="Tab1">
<div class="grid-tab_descript" keyword="de_id:Su5N7TepfGr">&nbsp;</div>

<div class="grid-SRH_ervices tableData"><!-- Encabezados de la tabla -->
<div class="grid-header" keyword="opt_c:ServSubcat">Services and service subcategories</div>

<div class="grid-header headerData" oulistdata="CL:StaticCL,AS:AssocCL,CB:CommDist,OU:MobileOU,VC:DigPlat">&nbsp;</div>
<!-- data row 1 -->

<div class="grid-cell subtitle grid_cell_merge6" keyword="opt_c:CServices">Contraceptive Services</div>
<!-- data row 2 -->

<div class="rowData" deid="j54Hd4Q6LtQ" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal1">&nbsp;</div>
<!-- DE 1, List of OUs --><!-- data row 3 -->

<div class="rowData" deid="PeDrIurYbaG" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal1">&nbsp;</div>
<!-- data row 4 -->

<div class="rowData" deid="rjHfp3CKQSV" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal1">&nbsp;</div>
<!-- data row 5 -->

<div class="rowData" deid="Lbf5GTNf3PR" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal1">&nbsp;</div>
<!-- data row 6 -->

<div class="rowData" deid="lUzx180Ag9e" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal1">&nbsp;</div>
<!-- data row 7 -->

<div class="rowData" deid="lRYgBXy3IGs" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal1">&nbsp;</div>
<!-- data row 7 -->

<div class="rowData" deid="MLJdstXcFhz" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal1">&nbsp;</div>
<!-- data row 8 -->

<div class="rowData" deid="v3Nr9RHKtpR" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal1">&nbsp;</div>
<!-- data row 9 -->

<div class="rowData" deid="p0uxRnLlmSs" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal1">&nbsp;</div>
<!-- data row 10 -->

<div class="rowData" deid="WI8eFPIhEMr" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal1">&nbsp;</div>
<!-- data row 11 -->

<div class="rowData" deid="uhjFn9cC20T" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal1">&nbsp;</div>
<!-- data row 12 -->

<div class="rowData" deid="sKYmLNwjUcv" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal1">&nbsp;</div>
<!-- data row 13 -->

<div class="rowData" deid="LDV1Z7UgZKX" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal1">&nbsp;</div>
<!-- data row 14 -->

<div class="rowData" deid="khUxWQko5ua" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal1">&nbsp;</div>
<!-- data row 15 -->

<div class="rowData" deid="bnDGzHahPmo" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal1">&nbsp;</div>
<!-- data row 16 -->

<div class="rowData" deid="f9wd4atMnCu" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal1">&nbsp;</div>
<!-- data row 17 -->

<div class="rowData" deid="Rtcm9Dwsz0H" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal1">&nbsp;</div>
<!-- data row 18 -->

<div class="rowData" deid="PbJfpERgVnd" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal1">&nbsp;</div>
<!-- data row 19 -->

<div class="rowData" deid="E5zau2tLtDq" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal1">&nbsp;</div>
<!-- data row 20 -->

<div class="rowData" deid="jBvSTjiWi9S" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal1">&nbsp;</div>
<!-- data row 21 -->

<div class="rowData" deid="Rq0Ih1OSyFo" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal1">&nbsp;</div>
<!-- data row 22 -->

<div class="rowData" deid="XqDoFSxyrTJ" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal1">&nbsp;</div>
<!-- data row 23 -->

<div class="rowData" deid="fdbBWNelqyY" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal1">&nbsp;</div>
<!-- data row 24 -->

<div class="rowData" deid="ggUdkoPGdhd" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal1">&nbsp;</div>
<!-- data row 25 -->

<div class="rowData" deid="JVSj8vd3vUN" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal1">&nbsp;</div>
<!-- data row 26 -->

<div class="rowData" deid="fjoAae7qPg0" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal1">&nbsp;</div>
<!-- data row 27 -->

<div class="rowData" deid="adHJeWhXulo" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal1">&nbsp;</div>
<!-- data row 28 -->

<div class="rowData" deid="E2qdJml6Q8W" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal1">&nbsp;</div>
<!-- data row 29 -->

<div class="rowData" deid="rwkeXBhrK6v" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal1">&nbsp;</div>
<!-- data row 30 -->

<div class="rowData" deid="qavW2jfJ4x1" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal1">&nbsp;</div>
<!-- data row 31 -->

<div class="rowData" deid="Ke6aRsbPgCP" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal1">&nbsp;</div>
<!-- data row 32 -->

<div class="rowData" deid="VapCNJi83oG" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal1">&nbsp;</div>
<!-- data row 33 -->

<div class="rowData" deid="EEUg6kb0qAv" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal1">&nbsp;</div>
<!-- data row 34 -->

<div class="rowData" deid="SI3AlbBfJgn" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal1">&nbsp;</div>
<!-- data row Subtotals -->

<div class="grid-cell title_row subtotals" keyword="opt_c:Stotals">Subtotals</div>

<div class="grid-cell data subtotals" subtotal1="col_1">&nbsp;</div>

<div class="grid-cell data subtotals" subtotal1="col_2">&nbsp;</div>

<div class="grid-cell data subtotals" subtotal1="col_3">&nbsp;</div>

<div class="grid-cell data subtotals" subtotal1="col_4">&nbsp;</div>

<div class="grid-cell data subtotals" subtotal1="col_5">&nbsp;</div>
<!-- data row 36 -->

<div class="grid-cell subtitle grid_cell_merge6" keyword="opt_c:AServices">Abortion Services</div>
<!-- data row 37 -->

<div class="rowData" deid="W0F5mM9oq2n" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal2">&nbsp;</div>
<!-- data row 38 -->

<div class="rowData" deid="T9q00GrdnWb" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal2">&nbsp;</div>
<!-- data row 39 -->

<div class="rowData" deid="bjRnWbSpwz1" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal2">&nbsp;</div>
<!-- data row 40 -->

<div class="rowData" deid="RlaZbKcZBHE" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal2">&nbsp;</div>
<!-- data row 41 -->

<div class="rowData" deid="IZYVOjZx6jp" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal2">&nbsp;</div>
<!-- data row 42 -->

<div class="rowData" deid="g0lynBElNh3" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal2">&nbsp;</div>
<!-- data row 43 -->

<div class="rowData" deid="DTatChN7dNU" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal2">&nbsp;</div>
<!-- data row 44 -->

<div class="rowData" deid="H93HkNHR5YG" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal2">&nbsp;</div>
<!-- data row 45 -->

<div class="rowData" deid="FBCiZCHMR0E" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal2">&nbsp;</div>
<!-- data row 46 -->

<div class="rowData" deid="nnWJY1vYjZA" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal2">&nbsp;</div>
<!-- data row 47 -->

<div class="rowData" deid="kjXi5WGk8y8" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal2">&nbsp;</div>
<!-- data row 48 -->

<div class="rowData" deid="PxlkeNQhU7K" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal2">&nbsp;</div>
<!-- data row 48 -->

<div class="rowData" deid="M8nrjyjbTw6" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal2">&nbsp;</div>
<!-- data row 50 -->

<div class="rowData" deid="q3d914oNtin" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal2">&nbsp;</div>
<!-- data row 51 -->

<div class="rowData" deid="aMtMJW9fDse" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal2">&nbsp;</div>
<!-- data row 52 -->

<div class="rowData" deid="eCriMzlfv9y" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal2">&nbsp;</div>
<!-- data row 53 -->

<div class="rowData" deid="oIV4DHEL2Jk" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal2">&nbsp;</div>
<!-- data row 54 -->

<div class="rowData" deid="JYFD50n4xST" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal2">&nbsp;</div>
<!-- data row 55 -->

<div class="rowData" deid="sQujXFjUwEw" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal2">&nbsp;</div>
<!-- data row 56 -->

<div class="rowData" deid="jHjiwdNTMws" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal2">&nbsp;</div>
<!-- data row 57 -->

<div class="rowData" deid="d4mtGl8P9eK" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal2">&nbsp;</div>
<!-- data row 58 -->

<div class="rowData" deid="WznnQbDA6XW" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal2">&nbsp;</div>
<!-- data row 59 -->

<div class="rowData" deid="ikmQSRkMJgV" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal2">&nbsp;</div>
<!-- data row Subtotals -->

<div class="grid-cell title_row subtotals" keyword="opt_c:Stotals">Subtotals</div>

<div class="grid-cell data subtotals" subtotal2="col_1">&nbsp;</div>

<div class="grid-cell data subtotals" subtotal2="col_2">&nbsp;</div>

<div class="grid-cell data subtotals" subtotal2="col_3">&nbsp;</div>

<div class="grid-cell data subtotals" subtotal2="col_4">&nbsp;</div>

<div class="grid-cell data subtotals" subtotal2="col_5">&nbsp;</div>
<!-- data row 60 -->

<div class="grid-cell subtitle grid_cell_merge6" keyword="opt_c:SSGBV Service">Specialized Sexual and Gender Based Violence (SGBV) Service</div>
<!-- data row 61 -->

<div class="rowData" deid="e3KKRrWyAzx" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal3">&nbsp;</div>
<!-- data row 62 -->

<div class="rowData" deid="NfEGYoUiysP" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal3">&nbsp;</div>
<!-- data row 63 -->

<div class="rowData" deid="vPuwOCfh87g" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal3">&nbsp;</div>
<!-- data row 64 -->

<div class="rowData" deid="D0EuC5WEsXo" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal3">&nbsp;</div>
<!-- data row 65 -->

<div class="rowData" deid="RIXGaI850Jz" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal3">&nbsp;</div>
<!-- data row 66 -->

<div class="rowData" deid="BSeN7HHSy9T" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal3">&nbsp;</div>
<!-- data row 67 -->

<div class="rowData" deid="vO9ai6WvkK8" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal3">&nbsp;</div>
<!-- data row Subtotals -->

<div class="grid-cell title_row subtotals" keyword="opt_c:Stotals">Subtotals</div>

<div class="grid-cell data subtotals" subtotal3="col_1">&nbsp;</div>

<div class="grid-cell data subtotals" subtotal3="col_2">&nbsp;</div>

<div class="grid-cell data subtotals" subtotal3="col_3">&nbsp;</div>

<div class="grid-cell data subtotals" subtotal3="col_4">&nbsp;</div>

<div class="grid-cell data subtotals" subtotal3="col_5">&nbsp;</div>
<!-- data row 68 -->

<div class="grid-cell subtitle grid_cell_merge6">
<div class="toggle" data-target="#content56"><span class="title" keyword="opt_c:OSRHS">Other Sexual and Reproductive Health Services</span></div>
</div>
<!-- data row 69 -->

<div class="rowData" deid="mPPm4axkvaA" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal4">&nbsp;</div>
<!-- data row 70 -->

<div class="rowData" deid="FuYlUWEpHMG" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal4">&nbsp;</div>
<!-- data row 71 -->

<div class="rowData" deid="XIhsYdDg1bM" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal4">&nbsp;</div>
<!-- data row 72 -->

<div class="rowData" deid="I0FWcXNWOvh" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal4">&nbsp;</div>
<!-- data row 73 -->

<div class="rowData" deid="yQUpzrEQ17t" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal4">&nbsp;</div>
<!-- data row 74 -->

<div class="rowData" deid="Lk6QcjFcIbN" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal4">&nbsp;</div>
<!-- data row 75 -->

<div class="rowData" deid="E9Ecb7Sss9D" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal4">&nbsp;</div>
<!-- data row 76 -->

<div class="rowData" deid="HNCcNVJX4XT" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal4">&nbsp;</div>
<!-- data row 77 -->

<div class="rowData" deid="cgjUOGsX5ui" optcomboid="mYU1cpPLbA3" outypes="*" showdescription="true" subtotal="subtotal4">&nbsp;</div>
<!-- data row Subtotals -->

<div class="grid-cell title_row subtotals" keyword="opt_c:Stotals">Subtotals</div>

<div class="grid-cell data subtotals" subtotal4="col_1">&nbsp;</div>

<div class="grid-cell data subtotals" subtotal4="col_2">&nbsp;</div>

<div class="grid-cell data subtotals" subtotal4="col_3">&nbsp;</div>

<div class="grid-cell data subtotals" subtotal4="col_4">&nbsp;</div>

<div class="grid-cell data subtotals" subtotal4="col_5">&nbsp;</div>
<!-- totals -->

<div class="grid-cell title_row totals" keyword="opt_c:TSChannel">Total Services by Channel</div>

<div class="grid-cell data totals">&nbsp;</div>

<div class="grid-cell data totals">&nbsp;</div>

<div class="grid-cell data totals">&nbsp;</div>

<div class="grid-cell data totals">&nbsp;</div>

<div class="grid-cell data totals">&nbsp;</div>
</div>
</div>
<!-- END TAB 1 --><!----------------------------------------------------------------------- --><!----------------------------------------------------------------------- --><!-- START TAB 2 -->

<div class="tabcontent" id="Tab2">
<div class="grid-tab_descript" keyword="de_id:HpdR9uIrDtw">&nbsp;</div>

<div class="grid-people_reached tableData"><!-- Encabezados de la tabla -->
<div class="grid-header" keyword="opt_c:SRHReach">People reached with SRH services, by total &amp; subpopulations</div>

<div class="grid-header headerData" oulistdata="CL:StaticCL,AS:AssocCL,CB:CommDist,OU:MobileOU,VC:DigPlat">&nbsp;</div>
<!-- data row 1 -->

<div class="rowData" deid="cwrWWxVQGuL" optcomboid="X66r2y4EuwS" outypes="*">&nbsp;</div>
<!-- data row 2 -->

<div class="grid-cell subtitle grid_cell_merge6" keyword="opt_c:Spopulations">Subpopulations *</div>
<!-- data row 3 -->

<div class="rowData" deid="Q8dEkfeJLrK" optcomboid="X66r2y4EuwS" outypes="*">&nbsp;</div>
<!-- data row 4 -->

<div class="rowData" deid="fgDxIco76sh" optcomboid="X66r2y4EuwS" outypes="*">&nbsp;</div>
<!-- data row 5 -->

<div class="rowData" deid="UAZmNSiKlOu" optcomboid="X66r2y4EuwS" outypes="*">&nbsp;</div>
<!-- data row 6 -->

<div class="rowData" deid="lQMsy46unSR" optcomboid="X66r2y4EuwS" outypes="*">&nbsp;</div>
</div>

<div class="grid-row" keyword="opt_c:Subpop">* Each subpopulation is a subset of total people reached with SRH care, and therefore they are less than or equal to &ldquo;Total # of all individuals reached with SRH services</div>

<div class="grid-textarea">
<div class="grid-row" keyword="opt_c:VulnFactor9">Please describe <b>what intersectional factors contribute to your definition of vulnerability</b> for your context:</div>

<div class="grid-row"><textarea></textarea></div>
</div>
</div>
<!-- END TAB 2 --><!----------------------------------------------------------------------- --><!----------------------------------------------------------------------- --><!-- START TAB 3 -->

<div class="tabcontent" id="Tab3">
<div class="grid-tab_descript" keyword="de_id:i47vDu7X0Kj">&nbsp;</div>

<div class="grid-commodities tableData"><!-- Encabezados de la tabla -->
<div class="grid-header" keyword="opt_c:Commod">Commodities</div>

<div class="grid-header headerData" oulistdata="CL:StaticCL,AS:AssocCL,CB:CommDist,OU:MobileOU,VC:DigPlat,GV:Gov,PR:PrivPhys,SM:SocMark,CM:CommMark,OT:OthAgen">&nbsp;</div>
<!-- data row 1 -->

<div class="grid-cell subtitle grid_cell_merge11" keyword="opt_c:CProducts">Contraceptive Products</div>
<!-- data row 2 -->

<div class="rowData" deid="Pc4HECU2C6v" optcomboid="X66r2y4EuwS" outypes="*">&nbsp;</div>
<!-- data row 3 -->

<div class="rowData" deid="D23SNhS7r8h" optcomboid="X66r2y4EuwS" outypes="*">&nbsp;</div>
<!-- data row 4 -->

<div class="rowData" deid="tWJ7wh7QZle" optcomboid="X66r2y4EuwS" outypes="*">&nbsp;</div>
<!-- data row 5 -->

<div class="rowData" deid="nzBtMcdxdXv" optcomboid="X66r2y4EuwS" outypes="*">&nbsp;</div>
<!-- data row 6 -->

<div class="rowData" deid="pcZvbST3Edy" optcomboid="X66r2y4EuwS" outypes="*">&nbsp;</div>
<!-- data row 7 -->

<div class="rowData" deid="OdxfYj9bZrH" optcomboid="X66r2y4EuwS" outypes="*">&nbsp;</div>
<!-- data row 8 -->

<div class="rowData" deid="xfZdBQSORHP" optcomboid="X66r2y4EuwS" outypes="*">&nbsp;</div>
<!-- data row 9 -->

<div class="rowData" deid="QDd1T3V6xKI" optcomboid="X66r2y4EuwS" outypes="*">&nbsp;</div>
<!-- data row 10 -->

<div class="rowData" deid="gFBnRoU36Ae" optcomboid="X66r2y4EuwS" outypes="*">&nbsp;</div>
<!-- data row 11 -->

<div class="rowData" deid="PZaWbFC0xNn" optcomboid="X66r2y4EuwS" outypes="*">&nbsp;</div>
<!-- data row 12 -->

<div class="rowData" deid="PXBPwlIyJ6P" optcomboid="X66r2y4EuwS" outypes="*">&nbsp;</div>
<!-- data row 13 -->

<div class="rowData" deid="gCusiC10adv" optcomboid="X66r2y4EuwS" outypes="*">&nbsp;</div>
<!-- data row 14 -->

<div class="rowData" deid="uaSyRGHlKLX" optcomboid="X66r2y4EuwS" outypes="*">&nbsp;</div>
<!-- data row 15 -->

<div class="rowData" deid="VSOV9bZ1gvU" optcomboid="X66r2y4EuwS" outypes="*">&nbsp;</div>
<!-- data row 16 -->

<div class="rowData" deid="fX9RwU6W8Sr" optcomboid="X66r2y4EuwS" outypes="*">&nbsp;</div>
<!-- data row 17 -->

<div class="rowData" deid="zfce6sFS3gH" optcomboid="X66r2y4EuwS" outypes="*">&nbsp;</div>
<!-- data row 18 -->

<div class="rowData" deid="L3ylCD0ervo" optcomboid="X66r2y4EuwS" outypes="*">&nbsp;</div>
<!-- data row 19 -->

<div class="rowData" deid="GsOfv12dYDp" optcomboid="X66r2y4EuwS" outypes="*">&nbsp;</div>
<!-- data row 20 -->

<div class="rowData" deid="Mip8cbS27v7" optcomboid="X66r2y4EuwS" outypes="*">&nbsp;</div>
<!-- data row 21 -->

<div class="rowData" deid="iyMFyHnnDWC" optcomboid="X66r2y4EuwS" outypes="*">&nbsp;</div>
<!-- data row 22 -->

<div class="rowData" deid="WTYD4RixHgc" optcomboid="X66r2y4EuwS" outypes="*">&nbsp;</div>
<!-- data row 23 -->

<div class="rowData" deid="A3XsTWylBFK" optcomboid="X66r2y4EuwS" outypes="*">&nbsp;</div>
<!-- data row 24 -->

<div class="grid-cell subtitle grid_cell_merge11" keyword="opt_c:AMedication">Abortion Medication</div>
<!-- data row 25 -->

<div class="rowData" deid="sajJKWIlO8t" optcomboid="X66r2y4EuwS" outypes="*">&nbsp;</div>
<!-- data row 26 -->

<div class="rowData" deid="gUeSdQdpmfB" optcomboid="X66r2y4EuwS" outypes="*">&nbsp;</div>
<!-- data row 27 -->

<div class="grid-cell subtitle grid_cell_merge11" keyword="opt_c:OCommodities">Other Commodities</div>
<!-- data row 10 -->

<div class="rowData" deid="TftnsPTqHh4" optcomboid="X66r2y4EuwS" outypes="*">&nbsp;</div>
</div>
</div>
<!-- END TAB 3 --><!----------------------------------------------------------------------- --><!----------------------------------------------------------------------- --><!-- START TAB 4 -->

<div class="tabcontent" id="Tab4">
<div class="grid-tab_descript" keyword="de_id:z3PdDSDp8B6">&nbsp;</div>

<div class="grid-CSE"><!-- Encabezados de la tabla -->
<div class="grid-header" keyword="opt_c:CSEInt">Direct CSE interventions</div>

<div class="grid-header" keyword="opt_c:SchlInPer">In-person in Schools</div>

<div class="grid-header" keyword="opt_c:CommInPer">In-person in Communities</div>

<div class="grid-header" keyword="opt_c:VirtDig">Virtually via Digital Platforms</div>
<!-- data row 1 -->

<div class="grid-cell title_row"># of young people trained as PEER EDUCATORS</div>

<div class="grid-cell data"><input id="euQ25evWoqO-Tl1HwncwQCa-val" name="entryfield" title="CSE - Young people trained as PEER EDUCATORS In schools" value="[ CSE - Young people trained as PEER EDUCATORS In schools ]" /></div>

<div class="grid-cell data"><input id="euQ25evWoqO-zGm2Fl4EE4n-val" name="entryfield" title="CSE - Young people trained as PEER EDUCATORS Outside of schools" value="[ CSE - Young people trained as PEER EDUCATORS Outside of schools ]" /></div>

<div class="grid-cell data"><input id="euQ25evWoqO-O2qUzJEe313-val" name="entryfield" title="CSE - Young people trained as PEER EDUCATORS Virtual/Digital" value="[ CSE - Young people trained as PEER EDUCATORS Virtual/Digital ]" /></div>
<!-- data row 2 -->

<div class="grid-cell title_row"># of young people reached with a COMPLETE series of your organization&acute;s CSE curriculum</div>

<div class="grid-cell data"><input id="eEMWRVGxi5P-Tl1HwncwQCa-val" name="entryfield" title="CSE - Young people reached with COMPLETE series In schools" value="[ CSE - Young people reached with COMPLETE series In schools ]" /></div>

<div class="grid-cell data"><input id="eEMWRVGxi5P-zGm2Fl4EE4n-val" name="entryfield" title="CSE - Young people reached with COMPLETE series Outside of schools" value="[ CSE - Young people reached with COMPLETE series Outside of schools ]" /></div>

<div class="grid-cell data"><input id="eEMWRVGxi5P-O2qUzJEe313-val" name="entryfield" title="CSE - Young people reached with COMPLETE series Virtual/Digital" value="[ CSE - Young people reached with COMPLETE series Virtual/Digital ]" /></div>
<!-- data row 3 -->

<div class="grid-cell title_row"># of young people reached with a PARTIAL series of your organization&acute;s CSE curriculum</div>

<div class="grid-cell data"><input id="gDvSAf1RuSu-Tl1HwncwQCa-val" name="entryfield" title="CSE - Young people reached with PARTIAL series In schools" value="[ CSE - Young people reached with PARTIAL series In schools ]" /></div>

<div class="grid-cell data"><input id="gDvSAf1RuSu-zGm2Fl4EE4n-val" name="entryfield" title="CSE - Young people reached with PARTIAL series Outside of schools" value="[ CSE - Young people reached with PARTIAL series Outside of schools ]" /></div>

<div class="grid-cell data"><input id="gDvSAf1RuSu-O2qUzJEe313-val" name="entryfield" title="CSE - Young people reached with PARTIAL series Virtual/Digital" value="[ CSE - Young people reached with PARTIAL series Virtual/Digital ]" /></div>
<!-- data row 4 -->

<div class="grid-cell title_row"># of young people reached with a SINGLE SESSION of your organization&acute;s CSE curriculum</div>

<div class="grid-cell data"><input id="AWrpCafv25G-Tl1HwncwQCa-val" name="entryfield" title="CSE - Young people reached with SINGLE SESSIONS In schools" value="[ CSE - Young people reached with SINGLE SESSIONS In schools ]" /></div>

<div class="grid-cell data"><input id="AWrpCafv25G-zGm2Fl4EE4n-val" name="entryfield" title="CSE - Young people reached with SINGLE SESSIONS Outside of schools" value="[ CSE - Young people reached with SINGLE SESSIONS Outside of schools ]" /></div>

<div class="grid-cell data"><input id="AWrpCafv25G-O2qUzJEe313-val" name="entryfield" title="CSE - Young people reached with SINGLE SESSIONS Virtual/Digital" value="[ CSE - Young people reached with SINGLE SESSIONS Virtual/Digital ]" /></div>
</div>

<div class="grid-tab_descript">
<div class="grid-row" keyword="opt_c:CSECurr">Please upload the most recent version of your CSE curriculum below:</div>

<div class="grid-row"><input id="F0KZC5qN4Rm-X66r2y4EuwS-val" name="entryfield" title="CSE - Upload CSE Curriculum" value="[ CSE - Upload CSE Curriculum ]" /></div>
</div>
</div>
<!-- END TAB 4 --><!----------------------------------------------------------------------- --><!----------------------------------------------------------------------- --><!-- START TAB 5 -->

<div class="tabcontent" id="Tab5">
<div class="grid-tab_descript" keyword="de_id:L93QCweEGhz">&nbsp;</div>

<div class="grid-OIES"><!-- Encabezados de la tabla -->
<div class="grid-header" keyword="opt_c:StakeGrp">Stakeholder Group</div>

<div class="grid-header" keyword="opt_c:InfoEdu"># of People from Stakeholder Group Reached with Information &amp; Education Sessions</div>
<!-- data row 1 -->

<div class="grid-cell">
<div class="grid-number">1&ordm;</div>

<div class="grid-data"><input id="cXkuwr2FJmf-X66r2y4EuwS-val" name="entryfield" title="Other Information &amp; Education Sessions - Stakeholder 1" value="[ Other Information &amp; Education Sessions - Stakeholder 1 ]" /></div>
</div>

<div class="grid-cell">
<div class="grid-number">1&ordm;</div>

<div class="grid-data"><input id="Dw1M300BT0E-X66r2y4EuwS-val" name="entryfield" title="Other Information &amp; Education Sessions - # of People from Stakeholder Group 1" value="[ Other Information &amp; Education Sessions - # of People from Stakeholder Group 1 ]" /></div>
</div>
<!-- data row 2 -->

<div class="grid-cell">
<div class="grid-number">2&ordm;</div>

<div class="grid-data"><input id="RQEEFfKclJ1-X66r2y4EuwS-val" name="entryfield" title="Other Information &amp; Education Sessions - Stakeholder 2" value="[ Other Information &amp; Education Sessions - Stakeholder 2 ]" /></div>
</div>

<div class="grid-cell">
<div class="grid-number">2&ordm;</div>

<div class="grid-data"><input id="axckh55ztly-X66r2y4EuwS-val" name="entryfield" title="Other Information &amp; Education Sessions - # of People from Stakeholder Group 2" value="[ Other Information &amp; Education Sessions - # of People from Stakeholder Group 2 ]" /></div>
</div>
<!-- data row 3 -->

<div class="grid-cell">
<div class="grid-number">3&ordm;</div>

<div class="grid-data"><input id="mrjIlCUE4HW-X66r2y4EuwS-val" name="entryfield" title="Other Information &amp; Education Sessions - Stakeholder 3" value="[ Other Information &amp; Education Sessions - Stakeholder 3 ]" /></div>
</div>

<div class="grid-cell">
<div class="grid-number">3&ordm;</div>

<div class="grid-data"><input id="DTTBokUZgd5-X66r2y4EuwS-val" name="entryfield" title="Other Information &amp; Education Sessions - # of People from Stakeholder Group 3" value="[ Other Information &amp; Education Sessions - # of People from Stakeholder Group 3 ]" /></div>
</div>
<!-- data row 4 -->

<div class="grid-cell">
<div class="grid-number">4&ordm;</div>

<div class="grid-data"><input id="qcJRWmlc56w-X66r2y4EuwS-val" name="entryfield" title="Other Information &amp; Education Sessions - Stakeholder 4" value="[ Other Information &amp; Education Sessions - Stakeholder 4 ]" /></div>
</div>

<div class="grid-cell">
<div class="grid-number">4&ordm;</div>

<div class="grid-data"><input id="iA2QY29PzV0-X66r2y4EuwS-val" name="entryfield" title="Other Information &amp; Education Sessions - # of People from Stakeholder Group 4" value="[ Other Information &amp; Education Sessions - # of People from Stakeholder Group 4 ]" /></div>
</div>
<!-- data row 5 -->

<div class="grid-cell">
<div class="grid-number">5&ordm;</div>

<div class="grid-data"><input id="zFUz0lKoA6f-X66r2y4EuwS-val" name="entryfield" title="Other Information &amp; Education Sessions - Stakeholder 5" value="[ Other Information &amp; Education Sessions - Stakeholder 5 ]" /></div>
</div>

<div class="grid-cell">
<div class="grid-number">5&ordm;</div>

<div class="grid-data"><input id="BsyRQBLaKHj-X66r2y4EuwS-val" name="entryfield" title="Other Information &amp; Education Sessions - # of People from Stakeholder Group 5" value="[ Other Information &amp; Education Sessions - # of People from Stakeholder Group 5 ]" /></div>
</div>
<!-- data row 6 -->

<div class="grid-cell">
<div class="grid-number">6&ordm;</div>

<div class="grid-data"><input id="OAsByFavhe4-X66r2y4EuwS-val" name="entryfield" title="Other Information &amp; Education Sessions - Stakeholder 6" value="[ Other Information &amp; Education Sessions - Stakeholder 6 ]" /></div>
</div>

<div class="grid-cell">
<div class="grid-number">6&ordm;</div>

<div class="grid-data"><input id="dGtCkSSeGI6-X66r2y4EuwS-val" name="entryfield" title="Other Information &amp; Education Sessions - # of People from Stakeholder Group 6" value="[ Other Information &amp; Education Sessions - # of People from Stakeholder Group 6 ]" /></div>
</div>
<!-- data row 7 -->

<div class="grid-cell">
<div class="grid-number">7&ordm;</div>

<div class="grid-data"><input id="TiMGsd064jo-X66r2y4EuwS-val" name="entryfield" title="Other Information &amp; Education Sessions - Stakeholder 7" value="[ Other Information &amp; Education Sessions - Stakeholder 7 ]" /></div>
</div>

<div class="grid-cell">
<div class="grid-number">7&ordm;</div>

<div class="grid-data"><input id="mqG6yMgyKnI-X66r2y4EuwS-val" name="entryfield" title="Other Information &amp; Education Sessions - # of People from Stakeholder Group 7" value="[ Other Information &amp; Education Sessions - # of People from Stakeholder Group 7 ]" /></div>
</div>
<!-- data row 8 -->

<div class="grid-cell">
<div class="grid-number">8&ordm;</div>

<div class="grid-data"><input id="spAMpsrVGAS-X66r2y4EuwS-val" name="entryfield" title="Other Information &amp; Education Sessions - Stakeholder 8" value="[ Other Information &amp; Education Sessions - Stakeholder 8 ]" /></div>
</div>

<div class="grid-cell">
<div class="grid-number">8&ordm;</div>

<div class="grid-data"><input id="qOC9tNlTK0O-X66r2y4EuwS-val" name="entryfield" title="Other Information &amp; Education Sessions - # of People from Stakeholder Group 8" value="[ Other Information &amp; Education Sessions - # of People from Stakeholder Group 8 ]" /></div>
</div>
<!-- data row 9 -->

<div class="grid-cell">
<div class="grid-number">9&ordm;</div>

<div class="grid-data"><input id="NWq0PsBWcSR-X66r2y4EuwS-val" name="entryfield" title="Other Information &amp; Education Sessions - Stakeholder 9" value="[ Other Information &amp; Education Sessions - Stakeholder 9 ]" /></div>
</div>

<div class="grid-cell">
<div class="grid-number">9&ordm;</div>

<div class="grid-data"><input id="yWNbZdTGa5Y-X66r2y4EuwS-val" name="entryfield" title="Other Information &amp; Education Sessions - # of People from Stakeholder Group 9" value="[ Other Information &amp; Education Sessions - # of People from Stakeholder Group 9 ]" /></div>
</div>
<!-- data row 10 -->

<div class="grid-cell">
<div class="grid-number">10&ordm;</div>

<div class="grid-data"><input id="ghIniF6PPfs-X66r2y4EuwS-val" name="entryfield" title="Other Information &amp; Education Sessions - Stakeholder 10" value="[ Other Information &amp; Education Sessions - Stakeholder 10 ]" /></div>
</div>

<div class="grid-cell">
<div class="grid-number">10&ordm;</div>

<div class="grid-data"><input id="kNVQVZ3uTZV-X66r2y4EuwS-val" name="entryfield" title="Other Information &amp; Education Sessions - # of People from Stakeholder Group 10" value="[ Other Information &amp; Education Sessions - # of People from Stakeholder Group 10 ]" /></div>
</div>
</div>

<div class="grid-tab_descript" keyword="de_id:L93QCweEGhz">&nbsp;</div>

<div class="grid-row"><input id="vct99nxy1en-X66r2y4EuwS-val" name="entryfield" title="Other Information &amp; Education Sessions - Document Upload" value="[ Other Information &amp; Education Sessions - Document Upload ]" /></div>

<div class="grid-tab_descript" keyword="de_id:HQ4Uq6qlrNk">&nbsp;</div>

<div class="grid-row"><input id="XlCqDWe7zqd-X66r2y4EuwS-val" name="entryfield" title="Other Information &amp; Education Sessions - Open Text" value="[ Other Information &amp; Education Sessions - Open Text ]" /></div>
</div>
<!-- END TAB 5 --><!----------------------------------------------------------------------- --></div>

<div class="version"><a href="https://docs.google.com/document/d/172FH65oMaIc2fFI3Ug0QT0TybZBPODsKIhg9Dm4Pd78" style="font-style: italic;font-size: 10px;" target="_blank">Version 1.0 SNAPSHOT 5</a></div>

<div class="inputCriteria" style="margin-top: 20px;"><button class="completeBtn">Submit</button><button class="runValidateBtn">Run Validation</button><button class="approvalBtn" style="display:none;">Approval Data</button></div>

<div class="dialog" style="display:none;">&nbsp;</div>
</div>
<script>
	$("body").on("focus", "input", function (event) {
		$(this).attr("autocomplete", "off");
	});

	var firstTab = $(".tablinks:first");
	firstTab.addClass("active");
	$("#" + firstTab.attr("data-target")).show();

	$(".tablinks").click(function () {
		var tabName = $(this).attr("data-target");

		$(".tabcontent").hide();
		$("#" + tabName).show();
		$(".tablinks").removeClass("active");
		$(this).addClass("active");
	});
  
    var BASE_QUERY_URL = "../api";

	// /** 
	//  * 0. data set with catoption ( default OR something else )
	//  * 1. Load grand-children of selected OUs
	//  * 2. Generate the header with grand-children OU list
	//  * 3. Reder rows with INPUT tags based on the deId and combId. Only render these INPUT fields based on the orgUnitType
	//  * 	3.1. Save data values, NEED TO take care of data set catOptionCombo ????
	//  * 4. Translation with content as HTML --> used a data element to save some common information ???
	//  * 5. Complete data set
	//  * 6. Validation Rules
	//  * 7. Approval Data
	// */

	// $(document).ready(function() {
		
	// });

	var app = new FosGrandChildrenOUsApp();

	
	// dhis2.de.event.formLoaded 
	$(document).off('dhis2.de.event.dataValuesLoaded').on('dhis2.de.event.dataValuesLoaded', function () {
		// Hide the Hide "Completed", "Validation", ... buttons which are generated from DHIS2 module for this form
		if( $(".fosGrandChildrenOUsCustomForm").length > 0 ) {
			$("#completenessDiv").hide();
			$("#actions").hide();
		} 
		else {
			$("#completenessDiv").show();
			$("#actions").hide();
		}

		// Generate form
		app.generateEntryForm($("#selectedPeriodId").val(), dhis2.de.currentOrganisationUnitId);
    });

	
	// === START - FosGrandChildrenOUsApp ============================================================
	function FosGrandChildrenOUsApp()
	{
		var me = this;

		me.selectedDataSetId;
		me.selectedOrgUnitId;
		me.selectedPeriodId;

		me.entryFormObj;
		me.inputFieldObj;
		me.approvalDataObj;
		me.validateDataObj;
		me.completeFormObj;

		me.grandChildOrgUnitList;
		me.isGeneratingForm = false;

		me.dataSetIdTag = $("#selectedDataSetId");
		me.periodIdSelectorTag = $("#selectedPeriodId");
		me.loaderDivTag = $("#loaderDiv");

		// 
		me.entryFormTag = $(".fosGrandChildrenOUsCustomForm");
		
		me.entryFormHeaderTags = me.entryFormTag.find(".headerData");
		me.rowDataTags = me.entryFormTag.find(".rowData");

		me.dialogTag = me.entryFormTag.find(".dialog");
		me.completeBtnTag = me.entryFormTag.find(".completeBtn");
		me.runValidateBtnTag = me.entryFormTag.find(".runValidateBtn");
		me.approvalBtnTag = me.entryFormTag.find(".approvalBtn");


		// ----------------------------------------------------------------------------------------
		// INIT method

		me.initilize = function()
		{
			me.entryFormTag.hide();

			me.isGeneratingForm = false;
			me.selectedDataSetId = me.dataSetIdTag.val();

			me.entryFormObj = new FosGrandChildrenOUs_EntryForm();
		}
		

		me.generateEntryForm = function( periodId, orgUnitId )
		{
			if( me.isGeneratingForm ) {
				console.log("Form is generating ... ");
				return;
			}
			me.isGeneratingForm = true;

			
			me.loaderDivTag.show();
			me.entryFormTag.hide();

			/** 
			 * A. If the new orgunit is selected
			 * 	1. Load grand-child orgunits again 
			 * 	2. If this selected orgunit has grand-child, 
			 *  	2.1. Generate emty form
			 * 		2.2. Render input fields
			 * 		2.3. Populate data values.
			 * 		2.4. Load validation rules configuration and approval data information
			 *  	2.5. Set up events for buttons ( Complete, Approve, Run Validate, ...).
			 * 
			 * 
			 * B. If the orgunit is not changed, periodId is changed 
			 * 	1. Render input fields again
			 * 	2. Populate data values.
			 * 	3. Load the new approval data information
			 *  4. Set up events for buttons ( Complete, Approve, Run Validate, ...).
			 * 
			 * **/
			try
			{
				if( orgUnitId != me.selectedOrgUnitId ) // A case
				{
					// STEP 0. Reset the form
					me.entryFormHeaderTags.html("");
					me.rowDataTags.html("");

					// STEP 1. Get the selected orgunit information
					me.generateEntryForm_OrgUnitChanged( periodId, orgUnitId );
				}
				else if( periodId != me.selectedPeriodId ) // B case
				{
					me.generateEntryForm_PeriodChanged( periodId, orgUnitId );
				}
			}
			catch( ex )
			{
				me.isGeneratingForm = false;
				me.loaderDivTag.hide();
				me.entryFormTag.hide();
				alert( "ERROR. Details: " + ex );
			}
			
		}

		me.generateEntryForm_OrgUnitChanged = function( periodId, orgUnitId, execFunc )
		{
			/** 
			 * A. If the new orgunit is selected
			 * 	1. Load grand-child orgunits again 
			 * 	2. If this selected orgunit has grand-child, 
			 *  	2.1. Generate emty form
			 * 		2.2. Render input fields
			 * 		2.3. Populate data values.
			 * 		2.4. Load validation rules configuration, completed form information and approval data information
			 *  	2.5. Set up events for buttons ( Complete, Approve, Run Validate, ...).
			 * **/
			 
			// STEP 1: Generate an emty form with header as grand-child orgUnits, and first columns as data element names
			me.entryFormObj.generateEntryForm( me.selectedDataSetId, orgUnitId, me.entryFormTag, function( response ){

				if( response.status == FosGrandChildrenOUsApp.RESPONSE_STATUS_SUCCESS )
				{
					me.orgUnitList = response.data;

					// STEP 4. Load validation rules configuration
					me.validateDataObj = new FosGrandChildrenOUs_Validation(me.selectedDataSetId, function(validationResponse){
						if( validationResponse.status == FosGrandChildrenOUsApp.RESPONSE_STATUS_SUCCESS )
						{	
							me.generateEntryForm_PeriodChanged( periodId, orgUnitId, execFunc );
						}
						else
						{
							me.generateEntryForm_Error(validationResponse, periodId, orgUnitId, execFunc);
						}

					} ) // END validateDataObj
				}
				else
				{
					me.generateEntryForm_Error(response, periodId, orgUnitId, execFunc);
				}
			 } );// END generateEntryForm
	
		}

		me.generateEntryForm_PeriodChanged = function( periodId, orgUnitId, execFunc )
		{
			/** 
			 * B. If the orgunit is not changed, periodId is changed 
			 * 	1. Render input fields again
			 * 	2. Populate data values.
			 * 	3. Load the new approval data information, and completed form information.
			 * 		3.1. Block form if the form is approved
			 *  4. Set up events for buttons ( Complete, Approve, Run Validate, ...).
			 * **/

			 // STEP 1. Render input fields
			me.entryFormObj.renderInputFields( me.selectedDataSetId, me.entryFormTag, periodId );

			// STEP 2. Populate data values
			me.entryFormObj.retrieveAndPopulateDataValues( me.selectedDataSetId, periodId, me.orgUnitList, me.entryFormTag, function(){
				
				// STEP 3. Load COMPLETED form information
				me.completeFormObj = new FosGrandChildrenOUs_CompleteForm(me.selectedDataSetId, periodId, me.orgUnitList, function(completedResponse){
					if( completedResponse.status == FosGrandChildrenOUsApp.RESPONSE_STATUS_SUCCESS )
					{			
						if( completedResponse.data.length > 0 ) me.completeBtnTag.html("In-Complete");
						else me.completeBtnTag.html("Complete");

						// // STEP 3. Load approval data information
						// me.approvalDataObj = new FosGrandChildrenOUs_ApprovalData( me.selectedDataSetId, periodId, orgUnitId, function(approvalDataResponse){
						// 	if( approvalDataResponse.status == FosGrandChildrenOUsApp.RESPONSE_STATUS_SUCCESS )
						// 	{
						// 		if( me.approvalDataObj.allowToApproveData ) {
						// 			// UnBlock the entry form so that user can enter data values
						// 			me.entryFormObj.blockEntryForm( me.entryFormTag, false ); // Block the entry form
						// 			me.approvalBtnTag.html("Approve");
						// 		}
						// 		else {
						// 			// Block the entry form
						// 			me.entryFormObj.blockEntryForm( me.entryFormTag, true ); 
						// 			me.approvalBtnTag.html("Un-Approve");
						// 		}

								// translation

								me.entryFormObj.translatePage( me.entryFormTag );

								// STEP 4. Set up events for buttons ( Complete, Approve, Run Validate, ...)
								me.setUp_Events( me.orgUnitList );

								me.isGeneratingForm = false;
								me.selectedPeriodId = periodId;
								me.selectedOrgUnitId = orgUnitId;
								me.loaderDivTag.hide();
								me.entryFormTag.show();

								if( execFunc ) execFunc();
						// 	}
						// 	else
						// 	{
						// 		me.generateEntryForm_Error( approvalDataResponse, periodId, orgUnitId, execFunc );
						// 	}

						// }); // END FosGrandChildrenOUs_ApprovalData
					}
					else
					{
						me.generateEntryForm_Error( completedResponse, periodId, orgUnitId, execFunc );
					}
				}); // END FosGrandChildrenOUs_CompleteForm

			}); // retrieveAndPopulateDataValues

		}

		me.generateEntryForm_Error = function( response, periodId, orgUnitId, execFunc )
		{
			if( response.status == FosGrandChildrenOUsApp.RESPONSE_STATUS_ERROR )
			{
				if( response.code == FosGrandChildrenOUsApp.ERROR_NO_CHILDREN_ORGUNIT )
				{
					alert("No Grand Children orgunits. Cannot generate the form.");
				}
				else if( response.code == FosGrandChildrenOUsApp.ERROR_DATA_SET_HAS_CAT_COMBO )
				{
					alert("Data set with caterory combo is not suppported.");
				}
				else if( response.code == FosGrandChildrenOUsApp.UNKNOWN )
				{
					alert( RESTUtils.getResponseErrorMsgIfAny(response) );
				}

				me.isGeneratingForm = false;	
				me.selectedPeriodId = periodId;
				me.selectedOrgUnitId = orgUnitId;
				me.loaderDivTag.hide();
				me.entryFormTag.hide();

				if(execFunc) execFunc();
			}
		}
		

		me.setUp_Events = function(orgUnitList)
		{
			me.completeBtnTag.off("click").on("click", function() {
				/** 
				 * Check Data set configuration, if the 'validCompleteOnly' is true OR 'compulsoryFieldsCompleteOnly' is true ==> Run validation / Make sure all compulsory data elements have data values.
				 *  
				 * **/
				// me.validCompleteOnly
				// me.compulsoryFieldsCompleteOnly
				

				var confirmMsg = ( me.completeFormObj.isCompleted ) ? "Are you sure you want to in-complete the form ?" : "Are you sure you want to complete the form ?";
				var ok = confirm(confirmMsg);
				if( ok )
				{
					var valid = true;

					// Current status is "In-complete" ==> need to check 'compulsary' and 'validations' to complete a form
					if( !me.completeFormObj.isCompleted ) 
					{
						// Check compulsary data elements if needed
						if( me.entryFormObj.dataSetConfig.compulsoryFieldsCompleteOnly || me.entryFormObj.dataSetConfig.fieldCombinationRequired )
						{
							valid = me.entryFormObj.checkCompulsaryDEs( me.entryFormTag );
							if( !valid )
							{
								alert("Please enter values for compulsary fields.");
							}
						}

						// Check validations if all of them are passed ONLY when it's needed
						if( valid && me.entryFormObj.dataSetConfig.validCompleteOnly )
						{
							me.validateDataObj.runValidations(me.selectedPeriodId, me.orgUnitList, function(response){
								if( response.data.valid )
								{
									// Run Complete/In-Complete Data set
									me.executeCompleteForm( me.selectedPeriodId, me.orgUnitList );
								}
								else
								{
									me.showValidationRuleDialog(response);
									alert("Please resolve the violated validations.");
								}
							});
						}
						else if( valid )
						{
							// Run Complete/In-Complete Data set
							me.executeCompleteForm( me.selectedPeriodId, me.orgUnitList );
						}
					}
					else
					{
						// Run Complete/In-Complete Data set
						me.executeCompleteForm( me.selectedPeriodId, me.orgUnitList );
					}
				}
			});

			me.approvalBtnTag.off("click").on("click", function() {
				var confirmMsg = ( me.approvalDataObj.allowToApproveData ) ? "Are you sure you want to approve data ?" : "Are you sure you want to unapprove data ?"
				var ok = confirm(confirmMsg);
				if( ok )
				{
					me.approvalDataObj.runApprovalData(me.selectedPeriodId, me.selectedOrgUnitId, function(response){
						if( me.approvalDataObj.allowToApproveData )
						{
							me.approvalBtnTag.html("Approve");
							setHeaderMessage( "The form is approved" );
						}
						else
						{
							me.approvalBtnTag.html("Un-Approve");
							setHeaderMessage( "The form is un-approved" );
						}
					});
				}
			});

			me.runValidateBtnTag.off("click").on("click", function() {
				me.validateDataObj.runValidations(me.selectedPeriodId, me.orgUnitList, function(response){
					me.showValidationRuleDialog(response);
				})
			});
		};

		me.executeCompleteForm =  function( periodId, orgUnitList )
		{
			me.completeFormObj.execute( me.selectedPeriodId, me.orgUnitList, function(response){
				if( response.status == FosGrandChildrenOUsApp.RESPONSE_STATUS_SUCCESS )
				{
					var label = ( me.completeFormObj.isCompleted ) ? "In-Completed" : "Completed";
					me.completeBtnTag.html(label);
				}

				alert( response.data.message );
			} );
		}

		me.showValidationRuleDialog = function(response)
		{
			var validationDivTag = response.data.validationDivTag;

			me.dialogTag.html("").append( validationDivTag );
			me.dialogTag.dialog({
				title: "Validation Rule",
				height: 500,
				width: 800,
				resizable: true,
				modal: true,
				buttons: {
					Close: function() {
						$( this ).dialog( 'close' );
					}
				}
			});
		}
		// ----------------------------------------------------------------------------------------
		// Run INIT method

		me.initilize();
	}
	
	FosGrandChildrenOUsApp.RESPONSE_STATUS_SUCCESS = "success";
	FosGrandChildrenOUsApp.RESPONSE_STATUS_ERROR = "error";

	FosGrandChildrenOUsApp.ERROR_NO_CHILDREN_ORGUNIT = "ERROR_NO_CHILDREN_ORGUNIT";
	FosGrandChildrenOUsApp.ERROR_DATA_SET_HAS_CAT_COMBO = "ERROR_DATA_SET_HAS_CAT_COMBO";
	FosGrandChildrenOUsApp.ERROR_DATA_VALUE_SAVED = "ERROR_DATA_VALUE_SAVED";
	FosGrandChildrenOUsApp.ERROR_UNKNOWN = "UNKNOWN";


	// === END - FosGrandChildrenOUsApp =====================================================================


	// === START - FosGrandChildrenOUs_EntryForm ============================================================
	function FosGrandChildrenOUs_EntryForm() {

		var me = this;


		me.PARAM_DATASET_ID = "@PARAM_DATASET_ID";
		me.PARAM_ORGUNIT_ID = "@PARAM_ORGUNIT_ID";

		me.API_BASE_QUERY_URL = BASE_QUERY_URL;

		// For data set
		me.QUERY_URL_LOAD_DATASET = `${me.API_BASE_QUERY_URL}/dataSets/${me.PARAM_DATASET_ID}.json?fields=fieldCombinationRequired,validCompleteOnly,compulsoryFieldsCompleteOnly,categoryCombo[id,categoryOptionCombos[id,displayName]],workflow,compulsoryDataElementOperands[id],dataSetElements[dataElement[id,displayFormName,*,categoryCombo[id,categoryOptionCombos[id,displayName]]]]`;

		// For OrgUnit
		me.QUERY_URL_LOAD_GRAND_CHILDREN_ORGUNITS = `${me.API_BASE_QUERY_URL}/organisationUnits/${me.PARAM_ORGUNIT_ID}.json?fields=children[children[id,displayName,code]]`;
		
		// For Data Values
		me.QUERY_URL_LOAD_DATA_VALUES = `${me.API_BASE_QUERY_URL}/dataValueSets?dataSet=${me.PARAM_DATASET_ID}&period=${me.PARAM_PERIOD_ID}&`; // &orgUnit=${me.PARAM_ORGUNIT_ID} ==> Will be generated orgunitList params later

		// For Option set translation
		me.QUERY_URL_SAVE_DATA_VALUE = `${me.API_BASE_QUERY_URL}/optionSets/xdBjO8vRHss.json?fields=options[code,displayName]`;

		// ----------------------------------------------------------------------------------------
		// Variables

		me.KEY_OPTION_CODE = "opt_c";
		me.KEY_DE_ID = "de_id";
		me.colorRed = '#ff8a8a';

		me.defaultCatComboId;
		me.dataElementMap;
		me.grandChildOrgUnitList;
		me.dataSetConfig;
		me.optionMap;

		me.inputFieldObj;

		// ----------------------------------------------------------------------------------------
		// INIT method

		me.initilize = function()
		{
			console.log("===================== FORM is INITILIZED");

			me.defaultCatComboId = dhis2.de.defaultCategoryCombo;
		}

		// ----------------------------------------------------------------------------------------
		// MAIN methods

		me.generateEntryForm = function( dataSetId, orgUnitId, entryFormTag, exeFunc )
		{
			me.retrieveGrandChildrenOUList( orgUnitId, function( granChidrenResponse ){
				if( granChidrenResponse.status == FosGrandChildrenOUsApp.RESPONSE_STATUS_SUCCESS )
				{
					var ouList = granChidrenResponse.data;
					
					me.retrieveDataSet( dataSetId, function( dataSetResponse ){
						if( dataSetResponse.status == FosGrandChildrenOUsApp.RESPONSE_STATUS_SUCCESS )
						{
							me.dataElementMap = dataSetResponse.data;

							me.retrieveOptionSet( function(optionSetResponse) {
								if( dataSetResponse.status == FosGrandChildrenOUsApp.RESPONSE_STATUS_SUCCESS )
								{
									me.inputFieldObj = new FosGrandChildrenInputField( entryFormTag, dataSetId, ouList, me.dataElementMap );

									var tableHeaderTags = entryFormTag.find(".headerData");
									var rowDataTags = entryFormTag.find(".rowData");

									me.renderTableHeaders(ouList, tableHeaderTags);
									me.renderDataRows( me.dataElementMap, ouList, rowDataTags );

									me.setUp_Events_DEDescriptionToggle(entryFormTag);

									if(exeFunc) exeFunc( granChidrenResponse ); // Return the granChidrenResponse so that we can have Grand-Children OUs later
								}
								else
								{
									if(exeFunc) exeFunc( optionSetResponse );	
								}
							}); // END retrieveOptionSet
						}
						else 
						{
							if(exeFunc) exeFunc( dataSetResponse );
						}
					} ); // END "retrieveDataSet"
				}
				else
				{
					if(exeFunc) exeFunc( granChidrenResponse );
				}

			} ) // END "retrieveGrandChildrenOUList"
		
		}

		me.renderInputFields = function( dataSetId, entryFormTag, periodId )
		{
			// me.inputFieldObj = new FosGrandChildrenInputField( dataSetId );

			entryFormTag.find(".inputDiv").html("");

			entryFormTag.find(".inputDiv").each(function(){
				var colTag = $(this);

				var deId = colTag.attr("deId");
				var ouId = colTag.attr("ouId");
				var optComboId = colTag.attr("optComboId");
				
				var dataElement = me.dataElementMap[deId];
				if( dataElement == undefined )
				{
					colTag.html(`<span style='color:red'>Not found data element ${deId}</span>`);
				}
				else
				{
					var inputTag = me.inputFieldObj.generateInputField( dataElement, periodId, ouId, optComboId );
					colTag.append( inputTag );
				}
			});
		}

		me.blockEntryForm = function( entryFormTag, blocked )
		{
			entryFormTag.find("input,select").prop("disabled", blocked);
			// entryFormTag.find("button").prop("disabled", blocked);
		}

		me.checkCompulsaryDEs = function( entryFormTag )
		{
			var valid = true;

			entryFormTag.find(`[compulsary="true"]`).each(function(){
				if( $(this).val() == "" )
				{
					$(this).css( "background-color", me.colorRed );
					valid = false;
				}
			});
			
			return valid;
		}

		// ----------------------------------------------------------------------------------------
		// Supportive methods - GENERATING FORMS related

		
			/** <div class="grid-header headerData" ouListData="CL:StaticCL,AS:AssocCL,CB:CommDist,OU:MobileOU,VC:DigPlat"></div>
			====>

			<div class="grid-header" keyword="opt_c:">Associated Clinics (AS)</div>
			<div class="grid-header" keyword="opt_c:">Community-Based Distribution / Services ()</div>
			<div class="grid-header" keyword="opt_c:">Mobile Outreach Units ()</div>
			<div class="grid-header" keyword="opt_c:">Digital Platforms ()</div>
			**/

		me.renderTableHeaders = function( ouList, tableHeaderTags )
		{
			tableHeaderTags.each(function(){
				var headerTag = $(this);
				headerTag.hide();
				
				
				var headerInfoData = headerTag.attr("ouListData").split(",");
				// for( var i=headerInfoData.length-1; i>=0; i-- )
				for( var i=0; i<headerInfoData.length; i++ )
				{
					var data = headerInfoData[i].split(":");
					var ouType = data[0];
					var transKeyword = data[1];

					var foundOuData = ouList.filter(function(item){ return item.code.substring( 0, 2 ) == ouType; } );
					if( foundOuData.length > 0 )
					{
						$(`<div class="grid-header colData" ouType="${ouType}" keyword="opt_c:${transKeyword}">${foundOuData[0].displayName}</div>`).insertBefore( headerTag );
					}
					else
					{
						$(`<div class="grid-header" style="color:red">Not found OrgUnit with TYPE ${ouType}</div>`).insertBefore( headerTag );
					}
				}
			});
		}


		/** 
		 * 
		<div class="rowData" deId="j54Hd4Q6LtQ" optComboId="mYU1cpPLbA3" ouTypes="CL,AS,CB,OU,VC"></div> <!-- DE 1, List of OUs -->
		==============>

		
		
		<div class="grid-cell title_row">
			<div class="toggle-data" data-target="#content1"><span class="title">Contraceptives – Counseling – General</span> <span class="info-icon">ℹ</span></div>

			<div class="content" id="content1" style="display: none;">A trained counselor/service provider shares person-specific non-directive advice about all available contraceptive methods before the person decides which is most suitable for them, to ensure their individual situation is considered in method selection, and that all possible options are made clear to them, in a space which allows confidentiality. This service should be recorded for people attending a contraceptive consultation for the first time and when considering switching methods, regardless of the method they select and even if they decide not to take up a method at that time.</div>
		</div>

		<div class="grid-cell data"></div>
		<div class="grid-cell data"></div>
		<div class="grid-cell data"></div>
		<div class="grid-cell data"></div>
		<div class="grid-cell data"></div> 
		 **/

		//  <div class="grid-header headerData" ouListData="CL:StaticCL,AS:AssocCL,CB:CommDist,OU:MobileOU,VC:DigPlat"></div>

		me.getOrgUnitTypesFromHeaderConfig = function( ouList, headerTag )
		{
			var typeMap = {}; // {"CL" : <ouData> }
			var headerInfoData = headerTag.attr("ouListData").split(",");
			for( var i=0; i<headerInfoData.length; i++ )
			{
				var data = headerInfoData[i].split(":");
				var ouType = data[0];

				var foundOuData = ouList.filter(function(item){ return item.code.substring( 0, 2 ) == ouType; } );
				typeMap[ouType] = ( foundOuData.length > 0 ) ? foundOuData[0] : undefined;
			}

			return typeMap;
		};

		me.renderDataRows = function( dataElementMap, ouList, rowDataTags )
		{
			rowDataTags.each(function(){
				var rowTag = $(this);
				rowTag.hide();
				
				var headerTag = rowTag.closest(".tableData").find(".headerData");
				var ouTypeMap = me.getOrgUnitTypesFromHeaderConfig( ouList, headerTag );

				// TODO: NEED to check if the deId, optComboId and ouTypes are defined properly
				var deId = rowTag.attr("deId");
				var optComboId = rowTag.attr("optComboId");
				var deOrgUnitTypes = rowTag.attr("ouTypes").split(",");

				var subtotal = rowTag.attr("subtotal");
				subtotal = (subtotal != undefined ) ? subtotal : "";

				var showDescription = rowTag.attr("showDescription");
				showDescription = (showDescription != undefined ) ? showDescription : false;


				var dataElement = dataElementMap[deId];
				if( dataElement == undefined )
				{
					deColTag = $(`<div class="grid-cell title_row" style='color:#eb3535;background-color:#edd8d8;'>Data element with id '${deId}' is missed.</div>`);
					deColTag.insertBefore( rowTag );
					for( var ouType in ouTypeMap )
					{
						$(`<div class='grid-cell data colData' style='color:#eb3535;background-color:#edd8d8;'></div>`).insertBefore( rowTag );
					}
				}
				else
				{
					// Add Data element column
					var colspusaryTag = ( dataElement.compulsary ) ? "<span style='color: red'> *</span>" : "";
					

					var deColTag;
					if( showDescription )
					{
						deColTag = $(`<div class="grid-cell title_row">
										<div class="toggle-data">
											<span class="title">${dataElement.displayFormName} ${colspusaryTag}</span> 
											<span class="info-icon">&#x2139;</span>
										</div>
										<div class="content" style="display: none;">${dataElement.displayDescription}</div>
									</div>`);
					}
					else
					{
						deColTag = $(`<div class="grid-cell title_row">${dataElement.displayFormName} ${colspusaryTag}</div>`);
					}

					deColTag.insertBefore( rowTag );
					// rowTag.append(deColTag);
					
					// Add INPUT columns
					var idx = 0;
					for( var ouType in ouTypeMap )
					{
						idx++;

						var ouData = ouTypeMap[ouType];
						if( ouData != undefined && ( deOrgUnitTypes.indexOf("*") >= 0 || deOrgUnitTypes.indexOf(ouType) >= 0 ) )
						{
							var colTag = $(`<div class='grid-cell data colData inputDiv' subtotal="${subtotal}" colIdx="${idx}" deId="${dataElement.id}" ouId="${ouData.id}" optComboId="${optComboId}"></div>`);
							colTag.insertBefore( rowTag );
							// rowTag.append(colTag);
						}
						else
						{
							$(`<div class='grid-cell data colData'></div>`).insertBefore( rowTag );
							// rowTag.append(`<div class='grid-cell data colData'></div>`);
						}
					}
				}
			});
		}

		me.setUp_Events_DEDescriptionToggle = function(entryFormTag)
		{
			entryFormTag.find(".toggle-data").click(function () {
				var target = $(this).closest(".title_row").find(".content");
				$(target).toggle();
			});
		}

		me.setGrandChildOrgUnitList = function( orgUnitData )
		{
			var ouList = [];

			var ouChildren = orgUnitData.children;
			if( ouChildren && ouChildren.length > 0 )
			{
				for (let i = 0; i < ouChildren.length; i++) {
					const ouChild = ouChildren[i];
					var ouGrandChildren = ouChild.children;
					if( ouGrandChildren != undefined && ouGrandChildren.length > 0 )
					{
						ouList = ouList.concat( ouGrandChildren );
					} 
				}
			}

			me.grandChildOrgUnitList = ouList;

			return ouList;
		}

		me.getOrgUnitType = function( orgUnitData )
		{
			return orgUnitData.code.substring( 0, 2 );
		}

		// ----------------------------------------------------------------------------------------
		// Supportive methods - DATA SET & DATA ELEMENT related

		me.retrieveDataSet = function( dataSetId, execFunc )
		{
			var url = me.QUERY_URL_LOAD_DATASET;
			url = url.replace(me.PARAM_DATASET_ID, dataSetId );

			RESTUtils.sendRequest( url, function(response){
				if( response.status == FosGrandChildrenOUsApp.RESPONSE_STATUS_SUCCESS )
				{
					if( response.data.categoryCombo.id != me.defaultCatComboId )
					{
						execFunc({status: FosGrandChildrenOUsApp.RESPONSE_STATUS_ERROR, code: FosGrandChildrenOUsApp.ERROR_DATA_SET_HAS_CAT_COMBO, data: response.data});
					}
					else
					{
						me.dataSetConfig = response.data;
						execFunc({status: FosGrandChildrenOUsApp.RESPONSE_STATUS_SUCCESS, data: me.getDataElementMap( response.data )});
					}
				}
				else
				{
					execFunc( response ); // UNKNOWN error case
				}
			} );
		}

		me.getDataElementMap = function( dataSetData )
		{
			var dataElementMap = {};

			var allFieldsRequired = dataSetData.fieldCombinationRequired; // All fields in entry form are mandatory
			var compulsoryDEList = dataSetData.compulsoryDataElementOperands;
			compulsoryDEList = ( compulsoryDEList ) ? compulsoryDEList : [];

			var dataSetElements = dataSetData.dataSetElements;
			for( var i=0; i<dataSetElements.length; i++)
			{
				var dataElement = dataSetElements[i].dataElement;

				// Set "compulsary" for each Data element
				var compulsary = (allFieldsRequired || compulsoryDEList.filter(function(item) { return item.id == dataElement.id }).length > 0 );
				dataElement.compulsary = compulsary;

				dataElementMap[dataElement.id] = dataElement;
			}

			return dataElementMap;
		}

		// ----------------------------------------------------------------------------------------
		// Supportive methods - Load DATA VALUES for FORM

		me.retrieveAndPopulateDataValues = function( dataSetId, periodId, orgUnitList, entryFormTag, execFunc )
		{
			entryFormTag.find("input,select").val("");
			me.retrieveDataValues( dataSetId, periodId, orgUnitList, function( response ){
				if( response.status == FosGrandChildrenOUsApp.RESPONSE_STATUS_SUCCESS )
				{
					// Populate data values
					var dataValues = response.data.dataValues;
					for (let i = 0; i < dataValues.length; i++) {
						const dataValue = dataValues[i];
						entryFormTag.find(`[deId="${dataValue.dataElement}"][optComboId="${dataValue.categoryOptionCombo}"][ouId="${dataValue.orgUnit}"]`).find("input,select").val( dataValue.value );
					}

					// Calculate Subtotals if any
					entryFormTag.find("[subtotal]").each(function(){
						var subtotalName = $(this).attr("subtotal");
						var colIdx = $(this).attr("colIdx");
						me.inputFieldObj.calcualteSubtotalIfAny( subtotalName, colIdx );
					})


					execFunc({status: FosGrandChildrenOUsApp.RESPONSE_STATUS_SUCCESS})
				}
				else
				{
					execFunc(response);
				}
			} )
		}

		me.retrieveDataValues = function( dataSetId, periodId, orgUnitList, execFunc )
		{
			// orgUnitParams ==> orgUnit=c0KSZZIXuuj&orgUnit=ygTzE0LlHYL
			var orgUnitParams = orgUnitList.map(function(item){ return `orgUnit=${item.id}`}).join("&");

			var url = me.QUERY_URL_LOAD_DATA_VALUES 
			url = url.replace( me.PARAM_DATASET_ID, dataSetId );
			url = url.replace( me.PARAM_PERIOD_ID, periodId );
			url += orgUnitParams;

			RESTUtils.sendRequest(url, execFunc, "GET");
		}


		// ----------------------------------------------------------------------------------------
		// Supportive methods - Retrieve Grand-Children of a selected OrgUnit

		me.retrieveGrandChildrenOUList = function( orgUnitId, exeFunc )
		{
			var url = me.QUERY_URL_LOAD_GRAND_CHILDREN_ORGUNITS;
			url = url.replace( me.PARAM_ORGUNIT_ID, orgUnitId );

			RESTUtils.sendRequest( url, function(response){
				if( response.status == FosGrandChildrenOUsApp.RESPONSE_STATUS_SUCCESS )
				{
					var grandChildOrgUnitList = me.setGrandChildOrgUnitList(response.data);

					if( grandChildOrgUnitList.length == 0 )
					{
						// alert("No Grand Children orgunits. Cannot generate the form");
						exeFunc({status: FosGrandChildrenOUsApp.RESPONSE_STATUS_ERROR, code: FosGrandChildrenOUsApp.ERROR_NO_CHILDREN_ORGUNIT });
					}
					else
					{
						exeFunc({status: FosGrandChildrenOUsApp.RESPONSE_STATUS_SUCCESS, code: FosGrandChildrenOUsApp.ERROR_UNKNOWN, data: grandChildOrgUnitList});
					}
				}
				else
				{
					exeFunc(response);
				}
			});
		}

		// ----------------------------------------------------------------------------------------
		// Supportive methods - TRANSLATION optionset

		me.retrieveOptionSet = function( execFunc )
		{
			RESTUtils.sendRequest( me.QUERY_URL_SAVE_DATA_VALUE, function(response) {
				var optionList = response.data.options;
				me.optionMap = optionList.reduce((json, value, key) => { json[value.code] = value.displayName; return json; }, {});

				execFunc( response );
			});
		}

		me.translatePage = function( entryFormTag )
		{
			entryFormTag.find("[keyword]").each(function(){
				var keys = $(this).attr("keyword").split(":");
				if( keys.length == 2 ) 
				{
					if( keys[0] == me.KEY_OPTION_CODE )
					{
						var translatedText = me.optionMap[keys[1]];
						translatedText = ( translatedText != undefined ) ? translatedText : keys[1];
						$(this).html( translatedText );
					}
					else if( keys[0] == me.KEY_DE_ID )
					{
						var dataElement = me.dataElementMap[keys[1]];
						var translatedText = ( dataElement != undefined ) ? dataElement.displayDescription : keys[1];
						$(this).html( translatedText );
					}
				}
			})
		}

		// ----------------------------------------------------------------------------------------
		// RUN Init method

		me.initilize();
	}
	// === END FosGrandChildrenOUs_EntryForm ================================================================


	// ===  START - Validation ==============================================================================
	// Check DE compulsory
	// Check Validation Rules
	function FosGrandChildrenOUs_Validation( _dataSetId, _initFunc ) {
		var me = this;

		me.dataSetId = _dataSetId;
		

		// ------------------------------------------------------------------------------------------
		// URLs

		me.PARAM_ORGUNIT_ID = "@PARAM_ORGUNIT_ID";
		me.PARAM_PERIOD_ID = "@PARAM_ORGUNIT_ID";
		me.PARAM_ORGUNIT_ID = "@PARAM_ORGUNIT_ID";

		me.API_BASE_QUERY_URL = BASE_QUERY_URL;

		// https://training.data.fosfeminista.org/api/validationRules?dataSet=uFurRa2Tc5G&fields=id,operator&paging=false
		me.QUERY_URL_GET_VALIDATION_RULES = `${me.API_BASE_QUERY_URL}/validationRules?dataSet=${me.dataSetId}&fields=id,operator&paging=false`;

		me.QUERY_URL_RUN_VALIDATION = `${me.API_BASE_QUERY_URL}/validation/dataSet/${me.dataSetId}.json?pe=${me.PARAM_PERIOD_ID}&ou=${me.PARAM_ORGUNIT_ID}`;


		// ------------------------------------------------------------------------------------------
		// variables

		me.VALIDATION_RULE_OPERATORS_MAP = {
			"equal_to": "=",	
			"not_equal_to": "!=",
			"greater_than": ">",
			"greater_than_or_equal_to": ">=",
			"less_than": "<",
			"less_than_or_equal_to": "<=",
			"compulsory_pair": "If either side is present, the other must also be",
			"exclusive_pair": "If either side is present, the other must not be"
		};

		me.operatorMap;

		// ------------------------------------------------------------------------------------------
		// INIT method

		me.initilize = function()
		{
			me.retrieveValidationRules(function( ruleResponse ){
				if( ruleResponse.status == FosGrandChildrenOUsApp.RESPONSE_STATUS_SUCCESS )
				{
					me.operatorMap = ruleResponse.data;
				}

				_initFunc( ruleResponse );
			})
		}

		
		// ------------------------------------------------------------------------------------------
		// Supportive methods - RUN VALIDATION for ORGUNIT LIST related

		me.runValidations = function( periodId, orgUnitList, execFunc )
		{
			if( me.operatorMap == undefined )
			{
				execDone({status: FosGrandChildrenOUsApp.RESPONSE_STATUS_SUCCESS, data: { valid: true } }); // No any validation rule is defined
			}
			else
			{
				var valid = true;

				var validationDivTag = me.generateValidationResult_Contents( orgUnitList );

				// Run validation rules
				me.total = orgUnitList.length;
				me.processingIdx = 0;

				for( let i = 0; i<orgUnitList.length; i++ )
				{
					const orgUnitData = orgUnitList[i];
					const ouValidationDivTag = validationDivTag.find(`[ouId="${orgUnitData.id}"]`);

					me.validate_OrgUnit( periodId, orgUnitData, me.operatorMap, ouValidationDivTag, function( response ){
						if( !response.data.valid ) valid = false;
						
						me.processingIdx++;
						if( me.processingIdx == me.total )
						{
							var statusData = {data: {valid: valid, validationDivTag: validationDivTag}};
							statusData.status = ( valid ) ? FosGrandChildrenOUsApp.RESPONSE_STATUS_SUCCESS : FosGrandChildrenOUsApp.RESPONSE_STATUS_ERROR;
							execFunc( statusData );
						} 
					})
				}

				// execFunc( divTag );
			}
		}

		me.generateValidationResult_Contents = function( orgUnitList )
		{
			var divTag = $(`<div></div>`);
			for( let i = 0; i<orgUnitList.length; i++ )
			{
				var orgUnitData = orgUnitList[i];

				divTag.append(`<h2>${orgUnitData.displayName}</h2>`);
				divTag.append(`<div ouId="${orgUnitData.id}"></div>`);
			}

			return divTag;
		}


		// ------------------------------------------------------------------------------------------
		// Supportive methods - VALIDATION RULES related

		me.retrieveValidationRules = function( execFunc )
		{
			RESTUtils.sendRequest( me.QUERY_URL_GET_VALIDATION_RULES, function(response){
				if( response.status == FosGrandChildrenOUsApp.RESPONSE_STATUS_SUCCESS )
				{
					if( response.data.validationRules.length > 0  )
					{
						execFunc({status: FosGrandChildrenOUsApp.RESPONSE_STATUS_SUCCESS, data: me.convertOperatorToSign( response.data.validationRules )});
					}
					else
					{
						execFunc({status: FosGrandChildrenOUsApp.RESPONSE_STATUS_SUCCESS, data: {}});
					}
				}
				else
				{
					execFunc( response );
				}
			} );
		}

		me.convertOperatorToSign = function( validationRuleList )
		{
			var operatorMap = {};
			for( var i=0; i<validationRuleList.length; i++ )
			{
				var rule = validationRuleList[i];
				operatorMap[rule.id] = me.VALIDATION_RULE_OPERATORS_MAP[rule.operator];
			}

			return operatorMap;
		}


		// ------------------------------------------------------------------------------------------
		// Supportive methods - RUN VALIDATION for ONLY ONE OrgUnit related

		me.validate_OrgUnit = function( periodId, orgUnitData, operatorMap, ouValidationTag, execFunc )
		{
			var url = me.QUERY_URL_RUN_VALIDATION;
			url = url.replace(me.PARAM_PERIOD_ID, periodId);
			url = url.replace(me.PARAM_ORGUNIT_ID, orgUnitData.id);

			RESTUtils.sendRequest( url, function(response){
				if( response.status == FosGrandChildrenOUsApp.RESPONSE_STATUS_SUCCESS )
				{

					var validationRuleViolations = response.data.validationRuleViolations;
					var resultTag = me.generateValidationResult_Table( orgUnitData, response.data, operatorMap );
					ouValidationTag.append( resultTag );

					var valid = ( validationRuleViolations.length > 0 );
					execFunc({status: FosGrandChildrenOUsApp.RESPONSE_STATUS_SUCCESS, data: { valid }});
				}
				else
				{
					var errorTag = me.generateErrorValidateMessage(response);
					ouValidationTag.append( errorTag );

					response.code = FosGrandChildrenOUsApp.ERROR_RUN_VALIDATION;
					response.data.valid = false;
					execFunc(response);
				}
			} );
		}
		
		me.generateValidationResult_Table = function( orgUnitData, validationResult, operatorMap )
		{
			var validationRuleViolations = validationResult.validationRuleViolations;
			var commentRequiredViolations = validationResult.commentRequiredViolations;

			if( validationRuleViolations.length > 0 )
			{
				var tableTag = $(`<div class="div-table entryForm"><div>`);

				// Header
				var headerTag = me.generateValidationResult_HeaderTag();
				tableTag.append( headerTag );

				// Rows
				for( var i=0; i<validationRuleViolations.length; i++ )
				{
					var violationResult = validationRuleViolations[i];
					var validationRule = violationResult.validationRule;

					var rowTag = $("<div class='div-table-row'></div>");
					rowTag.append(`<div class="div-table-col">${validationRule.displayName}</div>`);
					rowTag.append(`<div class="div-table-col">${violationResult.leftsideValue}</div>`);
					rowTag.append(`<div class="div-table-col">${operatorMap[validationRule.id]}</div>`);
					rowTag.append(`<div class="div-table-col">${violationResult.rightsideValue}</div>`);

					tableTag.append(rowTag);
				}

				// var divTag = $("<div></div>");
				// divTag.append(`<h2>${orgUnitData.displayName}</h2>`);
				// divTag.append( tableTag );

				// return divTag;

				return tableTag;
			}
			else
			{
				return me.generateSuccessValidateMessage();
			}

			// if( commentRequiredViolations.length > 0 )
			// {
			// 	// TODO : NEED TO find out what it is
			// }

			// if( validationRuleViolations.length == 0 && commentRequiredViolations.length == 0 )
		}

		me.generateSuccessValidateMessage = function()
		{
			return $( `<h3 style="color:green; padding-left: 10px;margin-bottom: 30px;">The data entry screen successfully passed validation.</h3>` );
		}

		me.generateErrorValidateMessage = function( response )
		{
			if( response.status == FosGrandChildrenOUsApp.RESPONSE_STATUS_ERROR )
			{
				var msg = "";
				if( response.data.message ) msg = response.data.message;

				return  $( `<h3 style="color:red; padding-left: 10px;margin-bottom: 30px;">Error while running validation.\n ${msg}</h3>` );
			}

			return "";
		}

		me.generateValidationResult_HeaderTag = function()
		{
			var headerTag = $("<div class='div-table-row header'></div>");

			headerTag.append("<div class='div-table-col'>Validation rule</div>");
			headerTag.append("<div class='div-table-col'>Left side</div>");
			headerTag.append("<div class='div-table-col'>Operator</div>");
			headerTag.append("<div class='div-table-col'>Right side</div>");

			return headerTag;

		}

		// ------------------------------------------------------------------------------------------
		// RUN init

		me.initilize();
	}

	// ===  END Validation ============================================================


	// ===  START - Approval Data  ============================================================================
	function FosGrandChildrenOUs_ApprovalData( _dataSetId, _periodId, _orgUnitId, _initFunc ) {
		var me = this;

		me.dataSetId = _dataSetId;
		me.periodId = _periodId;
		me.orgUnitId = _orgUnitId;

		// ------------------------------------------------------------------------------------------
		// URLs

		me.PARAM_ORGUNIT_ID = "@PARAM_ORGUNIT_ID";
		me.PARAM_PERIOD_ID = "@PARAM_PERIOD_ID";

		me.API_BASE_QUERY_URL = BASE_QUERY_URL;

		// https://training.data.fosfeminista.org/api/dataApprovals?ds=uFurRa2Tc5G&pe=202311&ou=c0KSZZIXuuj
		// GET method : Get approval information 
		// POST method : Approve form
		// DELETE method : Un-approve form
		me.QUERY_URL_APPROVAL_STATUS_GET = `${me.API_BASE_QUERY_URL}/dataApprovals?ds=${me.dataSetId}&pe=${me.PARAM_PERIOD_ID}&ou=${me.PARAM_ORGUNIT_ID}`;


		// ------------------------------------------------------------------------------------------
		// variables

		me.STATUS_DRAFT = "draft";
		me.STATUS_APPROVED = "approved";
		me.STATUS_ACCEPTED = "accepted";

		me.allowToApproveData;

		// ------------------------------------------------------------------------------------------
		// INIT method

		me.initilize = function()
		{
			me.retrieveApprovalDataStatus( me.periodId, me.orgUnitId, function( approvalDataResponse ){
				if( approvalDataResponse.status == FosGrandChildrenOUsApp.RESPONSE_STATUS_SUCCESS )
				{
					me.allowToApproveData = approvalDataResponse.data.mayApprove; // "mayApprove" means "Allow to Approve now"
				}

				_initFunc( approvalDataResponse );
			})
		}

		
		// ------------------------------------------------------------------------------------------
		// Supportive methods

		me.runApprovalData = function( periodId, orgUnitId, exeFunc )
		{
			if( me.allowToApproveData )
			{
				me.approveData( periodId, orgUnitId, function(response){
					me.allowToApproveData = false;
					exeFunc( response );
				} );
				
			}
			else
			{
				me.unapproveData( periodId, orgUnitId, function(response){
					me.allowToApproveData = true;
					exeFunc( response );
				} );
			}
		}

		me.allowToApproveData = function( approvalData )
		{
			return approvalData.mayApprove; // "mayApprove" means "Allow to Approve now"
		}

		me.retrieveApprovalDataStatus = function( periodId, orgUnitId, execFunc )
		{
			var url = me.QUERY_URL_APPROVAL_STATUS_GET;
			url = url.replace( me.PARAM_PERIOD_ID, periodId );
			url = url.replace( me.PARAM_ORGUNIT_ID, orgUnitId );
			RESTUtils.sendRequest( url, function(response){
				if( response.status == FosGrandChildrenOUsApp.RESPONSE_STATUS_SUCCESS )
				{
					me.allowToApproveData = response.data.mayApprove; // "mayApprove" means "Allow to Approve now"
				}

				execFunc( response );
			}, "GET" );
		}

		
		me.approveData = function( periodId, orgUnitId, execFunc )
		{
			var url = me.QUERY_URL_APPROVAL_STATUS_GET;
			url = url.replace( me.PARAM_PERIOD_ID, periodId );
			url = url.replace( me.PARAM_ORGUNIT_ID, orgUnitId );
			RESTUtils.sendRequest( url, function(response){
				if( response.status == FosGrandChildrenOUsApp.RESPONSE_STATUS_SUCCESS ) me.allowToApproveData = false;
				execFunc( response );
			}, "POST" );
		}

		me.unapproveData = function( periodId, orgUnitId, execFunc )
		{
			var url = me.QUERY_URL_APPROVAL_STATUS_GET;
			url = url.replace( me.PARAM_PERIOD_ID, periodId );
			url = url.replace( me.PARAM_ORGUNIT_ID, orgUnitId );
			RESTUtils.sendRequest( url, function(response){
				if( response.status == FosGrandChildrenOUsApp.RESPONSE_STATUS_SUCCESS ) me.allowToApproveData = true;
				execFunc( response );
			}, "DELETE" );
		}

		// ------------------------------------------------------------------------------------------
		// RUN init

		me.initilize();
	}
	// ===  END Validation ============================================================

	
	
	// ===  START - Complete/Incompete Data set form  ============================================================================
	function FosGrandChildrenOUs_CompleteForm( _dataSetId, _periodId, _orgUnitList, _initFunc ) {
		var me = this;

		me.dataSetId = _dataSetId;
		me.periodId = _periodId;
		me.orgUnitList = _orgUnitList;

		// ------------------------------------------------------------------------------------------
		// URLs

		me.API_BASE_QUERY_URL = BASE_QUERY_URL;

		// POST mehods
		// Payload
		//  {"completeDataSetRegistrations":[{"dataSet":"uFurRa2Tc5G","period":"202310","organisationUnit":"c0KSZZIXuuj","completed":true/false}]}
		// "completed": true ==> for completing a form
		// "completed": false ==> for in-completing a form
		me.QUERY_URL_COMPLETE_FORM_BASE = `${me.API_BASE_QUERY_URL}/completeDataSetRegistrations`;

		me.QUERY_URL_COMPLETE_FORM_GET = `${me.QUERY_URL_COMPLETE_FORM_BASE}?dataSet=${me.dataSetId}&period=${me.periodId}`; // ==> &orgUnit=XXX&orgUnit=XXX`;

		// ------------------------------------------------------------------------------------------
		// variables

		me.isCompleted;
		
		// ------------------------------------------------------------------------------------------
		// INIT method

		me.initilize = function()
		{
			me.retrieveCompleteStatus( me.orgUnitList, _initFunc );
		}

		
		// ------------------------------------------------------------------------------------------
		// Supportive methods

		me.retrieveCompleteStatus = function( orgUnitList, execFunc )
		{
			var ouParams = orgUnitList.map(function(item){ return `orgUnit=${item.id}`; }).join("&");

			var url = `${me.QUERY_URL_COMPLETE_FORM_GET}&${ouParams}`;
			RESTUtils.sendRequest( url, function(response){
				if( response.status == FosGrandChildrenOUsApp.RESPONSE_STATUS_SUCCESS )
				{
					var completeData = response.data.completeDataSetRegistrations;
					if( completeData && completeData.length > 0 )
					{
						me.isCompleted = true;
					}
					else {
						completeData = [];
						me.isCompleted = false;
					}
					execFunc({status: FosGrandChildrenOUsApp.RESPONSE_STATUS_SUCCESS, data: completeData});
				}
				else
				{
					execFunc( response );
				}
			}, "GET" );
		}
		

		me.execute = function( periodId, orgUnitList, execFunc )
		{
			if( me.isCompleted ) me.uncompleteForm( periodId, orgUnitList, execFunc );
			else me.completeForm( periodId, orgUnitList, execFunc );
		}

		me.completeForm = function( periodId, orgUnitList, execFunc )
		{
			var url = me.QUERY_URL_COMPLETE_FORM_BASE;
			var payload = me.generatePayload( periodId, orgUnitList, true );
			RESTUtils.sendRequest( url, function(response){
				execFunc( me.resolveResponse(response, true ) );
			}, "POST", payload, { "Content-Type": "application/json"});
		}

		
		me.uncompleteForm = function( periodId, orgUnitList, execFunc, headers )
		{
			var url = me.QUERY_URL_COMPLETE_FORM_BASE;

			var payload = me.generatePayload( periodId, orgUnitList, false );
			RESTUtils.sendRequest( url, function(response){
				execFunc( me.resolveResponse(response, false) );
			}, "POST", payload, { "Content-Type": "application/json"} );
		}

		me.generatePayload = function( periodId, orgUnitList, completed )
		{
			var commpletedList = orgUnitList.map(function(item){ 
				return {
					"dataSet": me.dataSetId,
					"period": periodId,
					"organisationUnit": item.id,
					"completed": completed
				} 
			});

			return { "completeDataSetRegistrations": commpletedList };
		}

		me.resolveResponse = function(response, isCompletedProcess)
		{
			if( response.status == FosGrandChildrenOUsApp.RESPONSE_STATUS_SUCCESS )
			{
				me.isCompleted = !me.isCompleted;

				var conflictData = response.data.response.conflicts;

				var resultStatus = {status: FosGrandChildrenOUsApp.RESPONSE_STATUS_SUCCESS, data: {} };
				if( conflictData && conflictData.length > 0 ) resultStatus.data.conflicts = conflictData;

				resultStatus.data.message = ( isCompletedProcess ) ? "Completed successfully" : "In-Completed successfully";

				return resultStatus;
			}
			else 
			{
				response.status = FosGrandChildrenOUsApp.RESPONSE_STATUS_ERROR;
				var msg =  ( isCompletedProcess ) ? "Completed failed" : "In-Completed failed";
				var responseJSON = response.data.responseJSON;
				if( responseJSON && responseJSON.response && responseJSON.response.description ) 
				{
					response.data.message = msg + "\n" + responseJSON.response.description;
				}
				else
				{
					response.data.message = msg;
				}
				
				return response;
			}
		}

		// ------------------------------------------------------------------------------------------
		// RUN init

		me.initilize();
	}
	// ===  END Validation ============================================================


	// ===  START - Complete/Incompete Data set form  ============================================================================
	function FosGrandChildrenInputField( _entryFormTag, _dataSetId, _ouList, _dataElementMap  ) {
		var me = this;

		me.entryFormTag = _entryFormTag;
		me.dataSetId = _dataSetId;
		me.ouList = _ouList;
		me.dataElementMap = _dataElementMap;

		// ------------------------------------------------------------------------------------------
		// URLs

		me.PARAM_DATA_ELEMENT_ID = "@PARAM_DATA_ELEMENT_ID";
		me.PARAM_PERIOD_ID = "@PARAM_PERIOD_ID";
		me.PARAM_DATA_VALUE = "@PARAM_DATA_VALUE";
		me.PARAM_ORGUNIT_ID = "@PARAM_ORGUNIT_ID";
		me.PARAM_CATOTION_COMBO_ID = "@PARAM_CATOTION_COMBO_ID";

		me.API_BASE_QUERY_URL = BASE_QUERY_URL;
		
		me.QUERY_URL_SAVE_DATA_VALUE = `${me.API_BASE_QUERY_URL}/dataValues?de=${me.PARAM_DATA_ELEMENT_ID}&co=${me.PARAM_CATOTION_COMBO_ID}&ds=${me.dataSetId}&ou=${me.PARAM_ORGUNIT_ID}&pe=${me.PARAM_PERIOD_ID}&value=${me.PARAM_DATA_VALUE}`;


		// ------------------------------------------------------------------------------------------
		// variables

		me.periodSelectorTag = $("#selectedPeriodId");

		me.colorGreen = '#b9ffb9';
		me.colorYellow = '#fffe8c';
		me.colorRed = '#ff8a8a';
		me.colorOrange = '#ff6600';
		me.colorWhite = '#fff';
		me.colorGrey = '#ccc';
		me.colorBorderActive = '#73ad72';
		me.colorBorder = '#aaa';
		me.colorLightGrey = '#dcdcdc';
		
		// ------------------------------------------------------------------------------------------
		// INIT method

		me.initilize = function()
		{
		
		}

		
		// ------------------------------------------------------------------------------------------
		// Supportive methods

		me.generateInputField = function( dataElement, periodId, orgUnitId, catOptionComboId )
		{
			var inputTag = $(`<input type='text' valueType="${dataElement.valueType}" compulsary="${dataElement.compulsary}" >`);
			
			if( dataElement.valueType == "INTEGER_ZERO_OR_POSITIVE" 
				|| dataElement.valueType == "INTEGER_POSITIVE" 
				|| dataElement.valueType == "NUMBER" )
			{
				inputTag.css("text-align", "right");
			}

			me.setup_Events_OnChange( inputTag, dataElement, periodId, orgUnitId, catOptionComboId );
			me.setup_Events_OnFocus( inputTag, dataElement, orgUnitId, catOptionComboId );

			return inputTag;
		}
		
		me.setup_Events_OnChange = function( inputTag, dataElement, periodId, orgUnitId, catOptionComboId )
		{
			inputTag.off("change").on("change", function() {
				var value = $(this).val();
				inputTag.css( "background-color", me.colorYellow );

				if( me.checkValueType( dataElement, value ) )
				{
					me.saveValue( dataElement.id, periodId, orgUnitId, catOptionComboId, $(this).val(), function(response){
						if( response.status == FosGrandChildrenOUsApp.RESPONSE_STATUS_SUCCESS )
						{
							inputTag.css( "background-color", me.colorGreen );

							// calculate subtotal if any
							var colDivTag = inputTag.closest(".colData ");
							var subtotalName = colDivTag.attr("subtotal");
							var colIdx = colDivTag.attr("colIdx");
							me.calcualteSubtotalIfAny( subtotalName, colIdx );
						}
						else{
							inputTag.css( "background-color", me.colorRed );
							if( response.code == FosGrandChildrenOUsApp.ERROR_DATA_VALUE_SAVED )
							{
								alert( RESTUtils.getResponseErrorMsgIfAny(response) );
							}
						}
						
					} );
				}
				else
				{
					inputTag.css( "background-color", me.colorRed );
				}
			});
		}

		me.setup_Events_OnFocus = function( inputTag, dataElement, orgUnitId, catOptionComboId )
		{
			inputTag.off("focus").on("focus", function() {
				var orgUnitMsg = "undefined";
				var deMsg = "undefined";
				var catOptComboMsg = "undefined";
				var periodMsg = me.periodSelectorTag.find("option:selected").text();

				var orgUnitData = me.ouList.filter(function(item){ return item.id == orgUnitId; });

				if( orgUnitData.length > 0 )
				{
					orgUnitMsg = orgUnitData[0].displayName;
				}
				if( dataElement != undefined )
				{
					deMsg = dataElement.displayFormName;
					var foundCatOptCombo = dataElement.categoryCombo.categoryOptionCombos.filter(function(item){ return item.id == catOptionComboId});
					if( foundCatOptCombo.length > 0 )
					{
						catOptComboMsg = foundCatOptCombo[0].displayName;
					}
				}

				me.openCurrentSelection( orgUnitData[0].displayName, periodMsg, deMsg, catOptComboMsg );
			});
		}

		me.calcualteSubtotalIfAny = function( subtotalName, colIdx )
		{
			if( subtotalName != "" )
			{
				var total = 0;
				var hasValue = false;
				me.entryFormTag.find(`[subtotal="${subtotalName}"][colIdx="${colIdx}"]`).each(function(){
					var inputTag = $(this).find("input,select");
					var value = inputTag.val();
					if( value != "" )
					{
						total += eval(value);
						hasValue = true;
					}
				})
				
				// subtotal TAG
				total = ( hasValue ) ? total : "-";
				me.entryFormTag.find(`[${subtotalName}="col_${colIdx}"]`).html( total );
			}
		}

		me.closeCurrentSelection = function()
		{
			$( "#currentSelection" ).fadeOut();
		}

		me.openCurrentSelection = function( orgUnitMsg, periodMsg, deMsg, catOptComboMsg )
		{
			var msgTag = $("#currentSelection");

			msgTag.find("#currentOrganisationUnit").html(orgUnitMsg);
			msgTag.find("#currentPeriod").html( periodMsg );
			msgTag.find("#currentDataElement").html(`${deMsg} (${catOptComboMsg})`);

			msgTag.css("z-index", "9999");
			msgTag.css("background-color", "#fff");
			msgTag.css("opacity", "1");

			msgTag.fadeIn();
		}


		
		me.checkValueType = function( dataElement, value )
		{	
			var valid = true;
			if( value != "" )
			{
				if( dataElement.valueType == "INTEGER_ZERO_OR_POSITIVE" )
				{
					valid = dhis2.validation.isZeroOrPositiveInt(value);
					if(!valid) {
						alert(`Value must be zero or a positive integer \n ${dataElement.displayFormName}`);
					}
				}
				else if( dataElement.valueType == "INTEGER_POSITIVE" )
				{
					valid = dhis2.validation.isPositiveInt(value);
					if(!valid) {
						alert(`Value must be a positive integer \n ${dataElement.displayFormName}`);
					}
				}
				else if( dataElement.valueType == "NUMBER" )
				{
					valid = dhis2.validation.isNumber(value);
					if(!valid) {
						alert(`Value must be a number \n ${dataElement.displayFormName}`);
					}
				}
			}
			
			return valid;
		}

		me.saveValue = function( deId, periodId, orgunitId, catOptionComboId, value, execFunc)
		{
			var url = me.QUERY_URL_SAVE_DATA_VALUE;
			url = url.replace( me.PARAM_DATA_VALUE, value );
			url = url.replace( me.PARAM_DATA_ELEMENT_ID, deId );
			url = url.replace( me.PARAM_PERIOD_ID, periodId );
			url = url.replace( me.PARAM_ORGUNIT_ID, orgunitId );
			url = url.replace( me.PARAM_CATOTION_COMBO_ID, catOptionComboId );

			RESTUtils.sendRequest( url, function(response){
				if( response.status == FosGrandChildrenOUsApp.RESPONSE_STATUS_SUCCESS )
				{
					if( response.data.status && response.data.status !== "OK" ) // ERROR
					{
						execFunc({status: FosGrandChildrenOUsApp.RESPONSE_STATUS_ERROR, code: FosGrandChildrenOUsApp.ERROR_DATA_VALUE_SAVED, data: response.data});
					}
					else
					{
						// {
						// 	"httpStatus": "Conflict",
						// 	"httpStatusCode": 409,
						// 	"status": "ERROR",
						// 	"message": "Data set is locked",
						// 	"errorCode": "E2017"
						// }
						execFunc({status: FosGrandChildrenOUsApp.RESPONSE_STATUS_SUCCESS});
					}
				}
				else
				{
					execFunc(response);
				}

			}, "POST" );
		}

		// ------------------------------------------------------------------------------------------
		// RUN init

		me.initilize();
	}
	// ===  END Validation ============================================================


	// === RESTUtils ==================================================================
	function RESTUtils() {}

	RESTUtils.sendRequest = function(url, exeFunc, method, payload, headers )
	{
		method = ( method == undefined ) ? "GET" : method;

		var options = {
			type: method,
			url: url,
			success: function( response )
			{
				exeFunc( {status: FosGrandChildrenOUsApp.RESPONSE_STATUS_SUCCESS, data: response, url} );
			},
			error: function( error )
			{
				exeFunc( {status: FosGrandChildrenOUsApp.RESPONSE_STATUS_ERROR, code: FosGrandChildrenOUsApp.ERROR_UNKNOWN ,data: error, url} );
			}
			
		};
		
		if( payload != undefined ) options.data = JSON.stringify(payload);
		if( headers != undefined ) options.headers = headers;

		$.ajax(options );
	}

	RESTUtils.getResponseErrorMsgIfAny = function(response)
	{
		var message = "";
		if( response.code == FosGrandChildrenOUsApp.ERROR_UNKNOWN )
		{
			var message = "ERROR";
			if( response.data.message ) 
			{
				message += ": " + response.data.message;
			}
		}

		return message;
		
	}
	// === END RESTUtils ==============================================================

  </script>